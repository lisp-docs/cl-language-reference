<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-chap-5/f-b-generalized-reference" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">5.1 Generalized Reference | Common Lisp (New) Language Reference</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://lisp-docs.github.io/cl-language-reference/img/1024px-Lisp_logo.svg.png"><meta data-rh="true" name="twitter:image" content="https://lisp-docs.github.io/cl-language-reference/img/1024px-Lisp_logo.svg.png"><meta data-rh="true" property="og:url" content="https://lisp-docs.github.io/cl-language-reference/docs/chap-5/f-b-generalized-reference"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="5.1 Generalized Reference | Common Lisp (New) Language Reference"><meta data-rh="true" name="description" content="5.1.1 Overview of Places and Generalized Reference"><meta data-rh="true" property="og:description" content="5.1.1 Overview of Places and Generalized Reference"><link data-rh="true" rel="icon" href="/cl-language-reference/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://lisp-docs.github.io/cl-language-reference/docs/chap-5/f-b-generalized-reference"><link data-rh="true" rel="alternate" href="https://lisp-docs.github.io/cl-language-reference/docs/chap-5/f-b-generalized-reference" hreflang="en"><link data-rh="true" rel="alternate" href="https://lisp-docs.github.io/cl-language-reference/docs/chap-5/f-b-generalized-reference" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://C1F2Q5VM6X-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/cl-language-reference/blog/rss.xml" title="Common Lisp (New) Language Reference RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/cl-language-reference/blog/atom.xml" title="Common Lisp (New) Language Reference Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Common Lisp (New) Language Reference" href="/cl-language-reference/opensearch.xml"><link rel="stylesheet" href="/cl-language-reference/assets/css/styles.ad20780e.css">
<script src="/cl-language-reference/assets/js/runtime~main.6d0fed48.js" defer="defer"></script>
<script src="/cl-language-reference/assets/js/main.de7ea857.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cl-language-reference/"><div class="navbar__logo"><img src="/cl-language-reference/img/logo.svg" alt="LISP Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/cl-language-reference/img/logo.svg" alt="LISP Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">CL Technical Reference </b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cl-language-reference/docs/intro">The CL Reference</a><a class="navbar__item navbar__link" href="/cl-language-reference/contribute">Contribute!</a><a class="navbar__item navbar__link" href="/cl-language-reference/todo">TODO</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/cl-language-reference/blog">Blog</a><a href="https://github.com/lisp-docs/cl-language-reference/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cl-language-reference/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/contents-and-figures">Contents and Figures</a><button aria-label="Expand sidebar category &#x27;Contents and Figures&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/1-introduction">1. Introduction</a><button aria-label="Expand sidebar category &#x27;1. Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/2-syntax">2. Syntax</a><button aria-label="Expand sidebar category &#x27;2. Syntax&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/3-evaluation-and-compilation">3. Evaluation and Compilation</a><button aria-label="Expand sidebar category &#x27;3. Evaluation and Compilation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/4-types-and-classes">4. Types and Classes</a><button aria-label="Expand sidebar category &#x27;4. Types and Classes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/cl-language-reference/docs/category/5-data-and-control-flow">5. Data and Control Flow</a><button aria-label="Collapse sidebar category &#x27;5. Data and Control Flow&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cl-language-reference/docs/chap-5/f-b-generalized-reference">5.1 Generalized Reference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cl-language-reference/docs/chap-5/f-c-transfer-of-control-to-an-exit-point">5.2 Transfer of Control to an Exit Point</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/cl-language-reference/docs/category/53-data-and-control-flow-dictionary">5.3 Data and Control Flow Dictionary</a><button aria-label="Expand sidebar category &#x27;5.3 Data and Control Flow Dictionary&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/6-iteration">6. Iteration</a><button aria-label="Expand sidebar category &#x27;6. Iteration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/7-objects">7. Objects</a><button aria-label="Expand sidebar category &#x27;7. Objects&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/8-structures">8. Structures</a><button aria-label="Expand sidebar category &#x27;8. Structures&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/9-conditions">9. Conditions</a><button aria-label="Expand sidebar category &#x27;9. Conditions&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/10-symbols">10. Symbols</a><button aria-label="Expand sidebar category &#x27;10. Symbols&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/11-packages">11. Packages</a><button aria-label="Expand sidebar category &#x27;11. Packages&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/12-numbers">12. Numbers</a><button aria-label="Expand sidebar category &#x27;12. Numbers&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/13-characters">13. Characters</a><button aria-label="Expand sidebar category &#x27;13. Characters&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/14-conses">14. Conses</a><button aria-label="Expand sidebar category &#x27;14. Conses&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/15-arrays">15. Arrays</a><button aria-label="Expand sidebar category &#x27;15. Arrays&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/16-strings">16. Strings</a><button aria-label="Expand sidebar category &#x27;16. Strings&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/17-sequences">17. Sequences</a><button aria-label="Expand sidebar category &#x27;17. Sequences&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/18-hash-tables">18. Hash Tables</a><button aria-label="Expand sidebar category &#x27;18. Hash Tables&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/19-filenames">19. Filenames</a><button aria-label="Expand sidebar category &#x27;19. Filenames&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/20-files">20. Files</a><button aria-label="Expand sidebar category &#x27;20. Files&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/21-streams">21. Streams</a><button aria-label="Expand sidebar category &#x27;21. Streams&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/22-printer">22. Printer</a><button aria-label="Expand sidebar category &#x27;22. Printer&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/23-reader">23. Reader</a><button aria-label="Expand sidebar category &#x27;23. Reader&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/24-system-construction">24. System Construction</a><button aria-label="Expand sidebar category &#x27;24. System Construction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/25-environment">25. Environment</a><button aria-label="Expand sidebar category &#x27;25. Environment&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/26-glossary">26. Glossary</a><button aria-label="Expand sidebar category &#x27;26. Glossary&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/cl-language-reference/docs/category/a-appendix">A. Appendix</a><button aria-label="Expand sidebar category &#x27;A. Appendix&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cl-language-reference/docs/code-blocks-double-slashes">Code Blocks TODO Fixes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cl-language-reference/docs/code-blocks">code-blocks</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/cl-language-reference/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/cl-language-reference/docs/category/5-data-and-control-flow"><span itemprop="name">5. Data and Control Flow</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">5.1 Generalized Reference</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>5.1 Generalized Reference</h1>
<!-- -->
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="511-overview-of-places-and-generalized-reference">5.1.1 Overview of Places and Generalized Reference<a href="#511-overview-of-places-and-generalized-reference" class="hash-link" aria-label="Direct link to 5.1.1 Overview of Places and Generalized Reference" title="Direct link to 5.1.1 Overview of Places and Generalized Reference">​</a></h2>
<!-- -->
<p>A <em>generalized reference</em> is the use of a <em>form</em>, sometimes called a <em>place</em>, as if it were a <em>variable</em> that could be read and written. The <em>value</em> of a <em>place</em> is the <em>object</em> to which the <em>place form</em> evaluates. The <em>value</em> of a <em>place</em> can be changed by using <strong>setf</strong>. The concept of binding a <em>place</em> is not defined</p>
<p>in Common Lisp, but an <em>implementation</em> is permitted to extend the language by defining this concept.</p>
<p>Figure 5–1 contains examples of the use of <strong>setf</strong>. Note that the values returned by evaluating the <em>forms</em> in column two are not necessarily the same as those obtained by evaluating the <em>forms</em> in column three. In general, the exact <em>macro expansion</em> of a <strong>setf</strong> <em>form</em> is not guaranteed and can even be <em>implementation-dependent</em>; all that is guaranteed is that the expansion is an update form that works for that particular <em>implementation</em>, that the left-to-right evaluation of <em>subforms</em> is preserved, and that the ultimate result of evaluating <strong>setf</strong> is the value or values being stored.</p>
<p>|<strong>Access function Update Function Update using setf</strong>
|</p>
<p>| :- |</p>
<p>|</p><p>x (setq x datum) (setf x datum) </p><p>(car x) (rplaca x datum) (setf (car x) datum) (symbol-value x) (set x datum) (setf (symbol-value x) datum)</p>|<p></p>
<p><strong>Figure 5–1. Examples of setf</strong></p>
<p>Figure 5–2 shows <em>operators</em> relating to <em>places</em> and <em>generalized reference</em>.</p>
<p>|</p><p><strong>assert defsetf push</strong> </p><p><strong>ccase get-setf-expansion remf</strong> </p><p><strong>ctypecase getf rotatef decf incf setf</strong> </p><p><strong>define-modify-macro pop shiftf define-setf-expander psetf</strong></p>|<p></p>
<p>| :- |</p>
<p><strong>Figure 5–2. Operators relating to places and generalized reference.</strong></p>
<p>Some of the <em>operators</em> above manipulate <em>places</em> and some manipulate <em>setf expanders</em>. A <em>setf expansion</em> can be derived from any <em>place</em>. New <em>setf expanders</em> can be defined by using <strong>defsetf</strong> and <strong>define-setf-expander</strong>.</p>
<p>Data and Control</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5111-evaluation-of-subforms-to-places">5.1.1.1 Evaluation of Subforms to Places<a href="#5111-evaluation-of-subforms-to-places" class="hash-link" aria-label="Direct link to 5.1.1.1 Evaluation of Subforms to Places" title="Direct link to 5.1.1.1 Evaluation of Subforms to Places">​</a></h3>
<!-- -->
<p>The following rules apply to the <em>evaluation</em> of <em>subforms</em> in a <em>place</em>:</p>
<p>1. The evaluation ordering of <em>subforms</em> within a <em>place</em> is determined by the order specified by the second value returned by <strong>get-setf-expansion</strong>. For all <em>places</em> defined by this specification (<em>e.g.</em>, <strong>getf</strong>, <strong>ldb</strong>, <em>. . .</em>), this order of evaluation is left-to-right. When a <em>place</em> is derived from a macro expansion, this rule is applied after the macro is expanded to find the appropriate <em>place</em>.</p>
<p><em>Places</em> defined by using <strong>defmacro</strong> or <strong>define-setf-expander</strong> use the evaluation order defined by those definitions. For example, consider the following:</p>
<p>(defmacro wrong-order (x y) ‘(getf ,y ,x))</p>
<p>This following <em>form</em> evaluates place2 first and then place1 because that is the order they are evaluated in the macro expansion:</p>
<p>(push value (wrong-order place1 place2))</p>
<p>2. For the <em>macros</em> that manipulate <em>places</em> (<strong>push</strong>, <strong>pushnew</strong>, <strong>remf</strong>, <strong>incf</strong>, <strong>decf</strong>, <strong>shiftf</strong>, <strong>rotatef</strong>, <strong>psetf</strong>, <strong>setf</strong>, <strong>pop</strong>, and those defined by <strong>define-modify-macro</strong>) the <em>subforms</em> of the macro call are evaluated exactly once in left-to-right order, with the <em>subforms</em> of the <em>places</em> evaluated in the order specified in (1).</p>
<p><strong>push</strong>, <strong>pushnew</strong>, <strong>remf</strong>, <strong>incf</strong>, <strong>decf</strong>, <strong>shiftf</strong>, <strong>rotatef</strong>, <strong>psetf</strong>, <strong>pop</strong> evaluate all <em>subforms</em> before modifying any of the <em>place</em> locations. <strong>setf</strong> (in the case when <strong>setf</strong> has more than two arguments) performs its operation on each pair in sequence. For example, in</p>
<p>(setf place1 value1 place2 value2 ...)</p>
<p>the <em>subforms</em> of place1 and value1 are evaluated, the location specified by place1 is modified to contain the value returned by value1, and then the rest of the <strong>setf</strong> form is processed in a like manner.</p>
<p>3. For <strong>check-type</strong>, <strong>ctypecase</strong>, and <strong>ccase</strong>, <em>subforms</em> of the <em>place</em> are evaluated once as in (1), but might be evaluated again if the type check fails in the case of <strong>check-type</strong> or none of the cases hold in <strong>ctypecase</strong> and <strong>ccase</strong>.</p>
<p>4. For <strong>assert</strong>, the order of evaluation of the generalized references is not specified. Rules 2, 3 and 4 cover all <em>standardized macros</em> that manipulate <em>places</em>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="51111-examples-of-evaluation-of-subforms-to-places">5.1.1.1.1 Examples of Evaluation of Subforms to Places<a href="#51111-examples-of-evaluation-of-subforms-to-places" class="hash-link" aria-label="Direct link to 5.1.1.1.1 Examples of Evaluation of Subforms to Places" title="Direct link to 5.1.1.1.1 Examples of Evaluation of Subforms to Places">​</a></h4>
<!-- -->
<p>(let ((ref2 (list ’())))</p>
<p>(push (progn (princ &quot;1&quot;) ’ref-1)</p>
<p>(car (progn (princ &quot;2&quot;) ref2))))</p>
<p>▷ 12</p>
<p>→ (REF1)</p>
<p>(let (x)</p>
<p>(push (setq x (list ’a))</p>
<p>(car (setq x (list ’b))))</p>
<p>x)</p>
<p>→ (((A) . B))</p>
<p><strong>push</strong> first evaluates (setq x (list ’a)) → (a), then evaluates (setq x (list ’b)) → (b), then modifies the <em>car</em> of this latest value to be ((a) . b).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5112-setf-expansions">5.1.1.2 Setf Expansions<a href="#5112-setf-expansions" class="hash-link" aria-label="Direct link to 5.1.1.2 Setf Expansions" title="Direct link to 5.1.1.2 Setf Expansions">​</a></h3>
<!-- -->
<p>Sometimes it is possible to avoid evaluating <em>subforms</em> of a <em>place</em> multiple times or in the wrong order. A <em>setf expansion</em> for a given access form can be expressed as an ordered collection of five <em>objects</em>:</p>
<p><strong>List of temporary variables</strong></p>
<p>a list of symbols naming temporary variables to be bound sequentially, as if by <strong>let*</strong>, to <em>values</em> resulting from value forms.</p>
<p><strong>List of value forms</strong></p>
<p>a list of forms (typically, <em>subforms</em> of the <em>place</em>) which when evaluated yield the values to which the corresponding temporary variables should be bound.</p>
<p><strong>List of store variables</strong></p>
<p>a list of symbols naming temporary store variables which are to hold the new values that will be assigned to the <em>place</em>.</p>
<p><strong>Storing form</strong></p>
<p>a form which can reference both the temporary and the store variables, and which changes the <em>value</em> of the <em>place</em> and guarantees to return as its values the values of the store variables, which are the correct values for <strong>setf</strong> to return.</p>
<p><strong>Accessing form</strong></p>
<p>a <em>form</em> which can reference the temporary variables, and which returns the <em>value</em> of the <em>place</em>.</p>
<p>The value returned by the accessing form is affected by execution of the storing form, but either of these forms might be evaluated any number of times.</p>
<p>Data and Control</p>
<p>It is possible to do more than one <strong>setf</strong> in parallel via <strong>psetf</strong>, <strong>shiftf</strong>, and <strong>rotatef</strong>. Because of this, the <em>setf expander</em> must produce new temporary and store variable names every time. For examples of how to do this, see <strong>gensym</strong>.</p>
<p>For each <em>standardized</em> accessor function <em>F</em>, unless it is explicitly documented otherwise, it is <em>implementation-dependent</em> whether the ability to use an <em>F form</em> as a <strong>setf</strong> <em>place</em> is implemented by a <em>setf expander</em> or a <em>setf function</em>. Also, it follows from this that it is <em>implementation-dependent</em> whether the name (setf <em>F</em>) is <em>fbound</em>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="51121-examples-of-setf-expansions">5.1.1.2.1 Examples of Setf Expansions<a href="#51121-examples-of-setf-expansions" class="hash-link" aria-label="Direct link to 5.1.1.2.1 Examples of Setf Expansions" title="Direct link to 5.1.1.2.1 Examples of Setf Expansions">​</a></h4>
<!-- -->
<p>Examples of the contents of the constituents of <em>setf expansions</em> follow.</p>
<p>For a variable <em>x</em>:</p>
<p>|</p><p>() ;list of temporary variables </p><p>() ;list of value forms </p><p>(g0001) ;list of store variables </p><p>(setq <em>x</em> g0001) ;storing form </p><p><em>x</em> ;accessing form</p>|<p></p>
<p>| :- |</p>
<p><strong>Figure 5–3. Sample Setf Expansion of a Variable</strong></p>
<p>For (car <em>exp</em>):</p>
<p>|</p><p>(g0002) ;list of temporary variables (<em>exp</em>) ;list of value forms </p><p>(g0003) ;list of store variables </p><p>(progn (rplaca g0002 g0003) g0003) ;storing form </p><p>(car g0002) ;accessing form</p>|<p></p>
<p>| :- |</p>
<p><strong>Figure 5–4. Sample Setf Expansion of a CAR Form</strong></p>
<p>For (subseq <em>seq s e</em>):</p>
<p>|</p><p>(g0004 g0005 g0006) ;list of temporary variables </p><p>(<em>seq s e</em>) ;list of value forms </p><p>(g0007) ;list of store variables </p><p>(progn (replace g0004 g0007 <!-- -->:start1<!-- --> g0005 <!-- -->:end1<!-- --> g0006) g0007) </p><p>;storing form </p><p>(subseq g0004 g0005 g0006) ; accessing form</p>|<p></p>
<p>| :- |</p>
<p><strong>Figure 5–5. Sample Setf Expansion of a SUBSEQ Form</strong></p>
<p>In some cases, if a <em>subform</em> of a <em>place</em> is itself a <em>place</em>, it is necessary to expand the <em>subform</em> in order to compute some of the values in the expansion of the outer <em>place</em>. For (ldb <em>bs</em> (car <em>exp</em>)):</p>
<p>|</p><p>(g0001 g0002) ;list of temporary variables </p><p>(<em>bs exp</em>) ;list of value forms </p><p>(g0003) ;list of store variables </p><p>(progn (rplaca g0002 (dpb g0003 g0001 (car g0002))) g0003) </p><p>;storing form </p><p>(ldb g0001 (car g0002)) ; accessing form</p>|<p></p>
<p>| :- |</p>
<p><strong>Figure 5–6. Sample Setf Expansion of a LDB Form</strong></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="512-kinds-of-places">5.1.2 Kinds of Places<a href="#512-kinds-of-places" class="hash-link" aria-label="Direct link to 5.1.2 Kinds of Places" title="Direct link to 5.1.2 Kinds of Places">​</a></h2>
<!-- -->
<p>Several kinds of <em>places</em> are defined by Common Lisp; this section enumerates them. This set can be extended by <em>implementations</em> and by <em>programmer code</em>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5121-variable-names-as-places">5.1.2.1 Variable Names as Places<a href="#5121-variable-names-as-places" class="hash-link" aria-label="Direct link to 5.1.2.1 Variable Names as Places" title="Direct link to 5.1.2.1 Variable Names as Places">​</a></h3>
<!-- -->
<p>The name of a <em>lexical variable</em> or <em>dynamic variable</em> can be used as a <em>place</em>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5122-function-call-forms-as-places">5.1.2.2 Function Call Forms as Places<a href="#5122-function-call-forms-as-places" class="hash-link" aria-label="Direct link to 5.1.2.2 Function Call Forms as Places" title="Direct link to 5.1.2.2 Function Call Forms as Places">​</a></h3>
<!-- -->
<p>A <em>function form</em> can be used as a <em>place</em> if it falls into one of the following categories:</p>
<p><em>•</em> A function call form whose first element is the name of any one of the functions in Figure 5–7.</p>
<p>Data and Control</p>
<p>|</p><p><strong>aref cdadr get</strong> </p><p><strong>bit cdar gethash</strong> </p><p><strong>caaaar cddaar logical-pathname-translations caaadr cddadr macro-function</strong> </p><p><strong>caaar cddar ninth</strong> </p><p><strong>caadar cdddar nth</strong> </p><p><strong>caaddr cddddr readtable-case</strong> </p><p><strong>caadr cdddr rest</strong> </p><p><strong>caar cddr row-major-aref</strong> </p><p><strong>cadaar cdr sbit</strong> </p><p><strong>cadadr char schar</strong> </p><p><strong>cadar class-name second</strong> </p><p><strong>caddar compiler-macro-function seventh</strong> </p><p><strong>cadddr documentation sixth</strong> </p><p><strong>caddr eighth slot-value</strong> </p><p><strong>cadr elt subseq</strong> </p><p><strong>car fdefinition svref</strong> </p><p><strong>cdaaar fifth symbol-function</strong> </p><p><strong>cdaadr fill-pointer symbol-plist</strong> </p><p><strong>cdaar find-class symbol-value</strong> </p><p><strong>cdadar first tenth</strong> </p><p><strong>cdaddr fourth third</strong></p>|<p></p>
<p>| :- |</p>
<p><strong>Figure 5–7. Functions that setf can be used with—1</strong></p>
<p>In the case of <strong>subseq</strong>, the replacement value must be a <em>sequence</em> whose elements might be contained by the sequence argument to <strong>subseq</strong>, but does not have to be a <em>sequence</em> of the same <em>type</em> as the <em>sequence</em> of which the subsequence is specified. If the length of the replacement value does not equal the length of the subsequence to be replaced, then the shorter length determines the number of elements to be stored, as for <strong>replace</strong>.</p>
<p><em>•</em> A function call form whose first element is the name of a selector function constructed by <strong>defstruct</strong>. The function name must refer to the global function definition, rather than a locally defined <em>function</em>.</p>
<p><em>•</em> A function call form whose first element is the name of any one of the functions in Figure 5–8, provided that the supplied argument to that function is in turn a <em>place</em> form; in this case the new <em>place</em> has stored back into it the result of applying the supplied “update” function.</p>
<p>|<strong>Function name Argument that is a</strong> <em>place</em> <strong>Update function used</strong>|</p>
<p>| :- |</p>
<p>|</p><p><strong>ldb</strong> second <strong>dpb</strong> </p><p><strong>mask-field</strong> second <strong>deposit-field</strong> </p><p><strong>getf</strong> first <em>implementation-dependent</em></p>|<p></p>
<p><strong>Figure 5–8. Functions that setf can be used with—2</strong></p>
<p>During the <strong>setf</strong> expansion of these <em>forms</em>, it is necessary to call <strong>get-setf-expansion</strong> in order to figure out how the inner, nested generalized variable must be treated.</p>
<p>The information from <strong>get-setf-expansion</strong> is used as follows.</p>
<p><strong>ldb</strong></p>
<p>In a form such as:</p>
<p>(setf (ldb <em>byte-spec place-form</em>) <em>value-form</em>)</p>
<p>the place referred to by the <em>place-form</em> must always be both <em>read</em> and <em>written</em>; note</p>
<p>that the update is to the generalized variable specified by <em>place-form</em>, not to any</p>
<p>object of <em>type</em> <strong>integer</strong>.</p>
<p>Thus this <strong>setf</strong> should generate code to do the following:</p>
<p>1. Evaluate <em>byte-spec</em> (and bind it into a temporary variable).</p>
<p>2. Bind the temporary variables for <em>place-form</em>.</p>
<p>3. Evaluate <em>value-form</em> (and bind its value or values into the store variable).</p>
<p>4. Do the <em>read</em> from <em>place-form</em>.</p>
<p>5. Do the <em>write</em> into <em>place-form</em> with the given bits of the <em>integer</em> fetched in</p>
<p>step 4 replaced with the value from step 3.</p>
<p>If the evaluation of <em>value-form</em> in step 3 alters what is found in <em>place-form</em>, such as</p>
<p>setting different bits of <em>integer</em> , then the change of the bits denoted by <em>byte-spec</em></p>
<p>is to that altered <em>integer</em> , because step 4 is done after the <em>value-form</em> evaluation.</p>
<p>Nevertheless, the evaluations required for <em>binding</em> the temporary variables are</p>
<p>done in steps 1 and 2, and thus the expected left-to-right evaluation order is seen.</p>
<p>For example:</p>
<p>(setq integer #x69) → #x69</p>
<p>(rotatef (ldb (byte 4 4) integer)</p>
<p>(ldb (byte 4 0) integer))</p>
<p>integer → #x96</p>
<p>;;; This example is trying to swap two independent bit fields</p>
<p>;;; in an integer. Note that the generalized variable of</p>
<p>;;; interest here is just the (possibly local) program variable</p>
<p>Data and Control</p>
<p>;;; integer.</p>
<p><strong>mask-field</strong></p>
<p>This case is the same as <strong>ldb</strong> in all essential aspects.</p>
<p><strong>getf</strong></p>
<p>In a form such as:</p>
<p>(setf (getf <em>place-form ind-form</em>) <em>value-form</em>)</p>
<p>the place referred to by <em>place-form</em> must always be both <em>read</em> and <em>written</em>; note that</p>
<p>the update is to the generalized variable specified by <em>place-form</em>, not necessarily to</p>
<p>the particular <em>list</em> that is the property list in question.</p>
<p>Thus this <strong>setf</strong> should generate code to do the following:</p>
<p>1. Bind the temporary variables for <em>place-form</em>.</p>
<p>2. Evaluate <em>ind-form</em> (and bind it into a temporary variable).</p>
<p>3. Evaluate <em>value-form</em> (and bind its value or values into the store variable).</p>
<p>4. Do the <em>read</em> from <em>place-form</em>.</p>
<p>5. Do the <em>write</em> into <em>place-form</em> with a possibly-new property list obtained</p>
<p>by combining the values from steps 2, 3, and 4. (Note that the phrase</p>
<p>“possibly-new property list” can mean that the former property list is</p>
<p>somehow destructively re-used, or it can mean partial or full copying of</p>
<p>it. Since either copying or destructive re-use can occur, the treatment</p>
<p>of the resultant value for the possibly-new property list must proceed as</p>
<p>if it were a different copy needing to be stored back into the generalized</p>
<p>variable.)</p>
<p>If the evaluation of <em>value-form</em> in step 3 alters what is found in <em>place-form</em>, such</p>
<p>as setting a different named property in the list, then the change of the property</p>
<p>denoted by <em>ind-form</em> is to that altered list, because step 4 is done after the</p>
<p><em>value-form</em> evaluation. Nevertheless, the evaluations required for <em>binding</em> the</p>
<p>temporary variables are done in steps 1 and 2, and thus the expected left-to-right</p>
<p>evaluation order is seen.</p>
<p>For example:</p>
<p>(setq s (setq r (list (list ’a 1 ’b 2 ’c 3)))) → ((a 1 b 2 c 3))</p>
<p>(setf (getf (car r) ’b)</p>
<p>(progn (setq r nil) 6)) → 6</p>
<p>r → NIL</p>
<p>s → ((A 1 B 6 C 3))</p>
<p>;;; Note that the (setq r nil) does not affect the actions of</p>
<p>;;; the SETF because the value of R had already been saved in</p>
<p>;;; a temporary variable as part of the step 1. Only the CAR</p>
<p>;;; of this value will be retrieved, and subsequently modified</p>
<p>;;; after the value computation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5123-values-forms-as-places">5.1.2.3 VALUES Forms as Places<a href="#5123-values-forms-as-places" class="hash-link" aria-label="Direct link to 5.1.2.3 VALUES Forms as Places" title="Direct link to 5.1.2.3 VALUES Forms as Places">​</a></h3>
<!-- -->
<p>A <strong>values</strong> <em>form</em> can be used as a <em>place</em>, provided that each of its <em>subforms</em> is also a <em>place</em> form. A form such as</p>
<p>(setf (values <em>place-1 . . . place-n</em>) <em>values-form</em>)</p>
<p>does the following:</p>
<p>1. The <em>subforms</em> of each nested <em>place</em> are evaluated in left-to-right order.</p>
<p>2. The <em>values-form</em> is evaluated, and the first store variable from each <em>place</em> is bound to its return values as if by <strong>multiple-value-bind</strong>.</p>
<p>3. If the <em>setf expansion</em> for any <em>place</em> involves more than one store variable, then the additional store variables are bound to <strong>nil</strong>.</p>
<p>4. The storing forms for each <em>place</em> are evaluated in left-to-right order.</p>
<p>The storing form in the <em>setf expansion</em> of <strong>values</strong> returns as <em>multiple values</em><sub>2</sub> the values of the store variables in step 2. That is, the number of values returned is the same as the number of <em>place</em> forms. This may be more or fewer values than are produced by the <em>values-form</em>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5124-the-forms-as-places">5.1.2.4 THE Forms as Places<a href="#5124-the-forms-as-places" class="hash-link" aria-label="Direct link to 5.1.2.4 THE Forms as Places" title="Direct link to 5.1.2.4 THE Forms as Places">​</a></h3>
<!-- -->
<p>A <strong>the</strong> <em>form</em> can be used as a <em>place</em>, in which case the declaration is transferred to the <em>newvalue</em> form, and the resulting <strong>setf</strong> is analyzed. For example,</p>
<p>(setf (the integer (cadr x)) (+ y 3))</p>
<p>is processed as if it were</p>
<p>(setf (cadr x) (the integer (+ y 3)))</p>
<p>Data and Control</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5125-apply-forms-as-places">5.1.2.5 APPLY Forms as Places<a href="#5125-apply-forms-as-places" class="hash-link" aria-label="Direct link to 5.1.2.5 APPLY Forms as Places" title="Direct link to 5.1.2.5 APPLY Forms as Places">​</a></h3>
<!-- -->
<p>The following situations involving <strong>setf</strong> of <strong>apply</strong> must be supported:</p>
<p><em>•</em> (setf (apply #’aref <em>array {subscript}</em>* <em>more-subscripts</em>) <em>new-element</em>)</p>
<p><em>•</em> (setf (apply #’bit <em>array {subscript}</em>* <em>more-subscripts</em>) <em>new-element</em>)</p>
<p><em>•</em> (setf (apply #’sbit <em>array {subscript}</em>* <em>more-subscripts</em>) <em>new-element</em>)</p>
<p>In all three cases, the <em>element</em> of <em>array</em> designated by the concatenation of <em>subscripts</em> and <em>more-subscripts</em> (<em>i.e.</em>, the same <em>element</em> which would be <em>read</em> by the call to <em>apply</em> if it were not part of a <strong>setf</strong> <em>form</em>) is changed to have the <em>value</em> given by <em>new-element</em>. For these usages, the function name (<strong>aref</strong>, <strong>bit</strong>, or <strong>sbit</strong>) must refer to the global function definition, rather than a locally defined <em>function</em>.</p>
<p>No other <em>standardized function</em> is required to be supported, but an <em>implementation</em> may define such support. An <em>implementation</em> may also define support for <em>implementation-defined operators</em>.</p>
<p>If a user-defined <em>function</em> is used in this context, the following equivalence is true, except that care is taken to preserve proper left-to-right evaluation of argument <em>subforms</em>:</p>
<p>(setf (apply #’<em>name {arg}</em>*) <em>val</em>)</p>
<p><em>≡</em> (apply #’(setf <em>name</em>) <em>val {arg}</em>*)</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5126-setf-expansions-and-places">5.1.2.6 Setf Expansions and Places<a href="#5126-setf-expansions-and-places" class="hash-link" aria-label="Direct link to 5.1.2.6 Setf Expansions and Places" title="Direct link to 5.1.2.6 Setf Expansions and Places">​</a></h3>
<!-- -->
<p>Any <em>compound form</em> for which the <em>operator</em> has a <em>setf expander</em> defined can be used as a <em>place</em>. The <em>operator</em> must refer to the global function definition, rather than a locally defined <em>function</em> or <em>macro</em>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5127-macro-forms-as-places">5.1.2.7 Macro Forms as Places<a href="#5127-macro-forms-as-places" class="hash-link" aria-label="Direct link to 5.1.2.7 Macro Forms as Places" title="Direct link to 5.1.2.7 Macro Forms as Places">​</a></h3>
<!-- -->
<p>A <em>macro form</em> can be used as a <em>place</em>, in which case Common Lisp expands the <em>macro form</em> as if by <strong>macroexpand-1</strong> and then uses the <em>macro expansion</em> in place of the original <em>place</em>. Such <em>macro expansion</em> is attempted only after exhausting all other possibilities other than expanding into a call to a function named (setf <em>reader</em>).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5128-symbol-macros-as-places">5.1.2.8 Symbol Macros as Places<a href="#5128-symbol-macros-as-places" class="hash-link" aria-label="Direct link to 5.1.2.8 Symbol Macros as Places" title="Direct link to 5.1.2.8 Symbol Macros as Places">​</a></h3>
<!-- -->
<p>A reference to a <em>symbol</em> that has been <em>established</em> as a <em>symbol macro</em> can be used as a <em>place</em>. In this case, <strong>setf</strong> expands the reference and then analyzes the resulting <em>form</em>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5129-other-compound-forms-as-places">5.1.2.9 Other Compound Forms as Places<a href="#5129-other-compound-forms-as-places" class="hash-link" aria-label="Direct link to 5.1.2.9 Other Compound Forms as Places" title="Direct link to 5.1.2.9 Other Compound Forms as Places">​</a></h3>
<!-- -->
<p>For any other <em>compound form</em> for which the <em>operator</em> is a <em>symbol f</em> , the <strong>setf</strong> <em>form</em> expands into a call to the <em>function</em> named (setf <em>f</em> ). The first <em>argument</em> in the newly constructed <em>function form</em> is <em>newvalue</em> and the remaining <em>arguments</em> are the remaining <em>elements</em> of <em>place</em>. This expansion occurs</p>
<p>regardless of whether <em>f</em> or (setf <em>f</em> ) is defined as a <em>function</em> locally, globally, or not at all. For example,</p>
<p>(setf (<em>f arg1 arg2</em> ...) <em>new-value</em>)</p>
<p>expands into a form with the same effect and value as</p>
<p>(let ((#<!-- -->:temp-1<!-- --> arg1) ;force correct order of evaluation</p>
<p>(#<!-- -->:temp-2<!-- --> arg2)</p>
<p>...</p>
<p>(#<!-- -->:temp-0<!-- --> <em>new-value</em>))</p>
<p>(funcall (function (setf <em>f</em> )) #<!-- -->:temp-0<!-- --> #<!-- -->:temp-1<!-- --> #<!-- -->:temp-2<!-- -->...))</p>
<p>A <em>function</em> named (setf <em>f</em> ) must return its first argument as its only value in order to preserve the semantics of <strong>setf</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="513-treatment-of-other-macros-based-on-setf">5.1.3 Treatment of Other Macros Based on SETF<a href="#513-treatment-of-other-macros-based-on-setf" class="hash-link" aria-label="Direct link to 5.1.3 Treatment of Other Macros Based on SETF" title="Direct link to 5.1.3 Treatment of Other Macros Based on SETF">​</a></h2>
<!-- -->
<!-- -->
<p>For each of the “read-modify-write” <em>operators</em> in Figure 5–9, and for any additional <em>macros</em> defined by the <em>programmer</em> using <strong>define-modify-macro</strong>, an exception is made to the normal rule of left-to-right evaluation of arguments. Evaluation of <em>argument forms</em> occurs in left-to-right order, with the exception that for the <em>place argument</em>, the actual <em>read</em> of the “old value” from that <em>place</em> happens after all of the <em>argument form evaluations</em>, and just before a “new value” is computed and <em>written</em> back into the <em>place</em>.</p>
<p>Specifically, each of these <em>operators</em> can be viewed as involving a <em>form</em> with the following general syntax:</p>
<p>(<em>operator {preceding-form}</em>* <em>place {following-form}</em>*)</p>
<p>The evaluation of each such <em>form</em> proceeds like this:</p>
<p>1. <em>Evaluate</em> each of the <em>preceding-forms</em>, in left-to-right order.</p>
<p>2. <em>Evaluate</em> the <em>subforms</em> of the <em>place</em>, in the order specified by the second value of the <em>setf expansion</em> for that <em>place</em>.</p>
<p>3. <em>Evaluate</em> each of the <em>following-forms</em>, in left-to-right order.</p>
<p>4. <em>Read</em> the old value from <em>place</em>.</p>
<p>5. Compute the new value.</p>
<p>6. Store the new value into <em>place</em>.</p>
<p>Data and Control</p>
<p>|</p><p><strong>decf pop pushnew</strong> </p><p><strong>incf push remf</strong></p>|<p></p>
<p>| :- |</p>
<p><strong>Figure 5–9. Read-Modify-Write Macros</strong></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/lisp-docs/cl-language-reference/tree/develop/docs/chap-5/f-b-generalized-reference.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cl-language-reference/docs/category/5-data-and-control-flow"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">5. Data and Control Flow</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cl-language-reference/docs/chap-5/f-c-transfer-of-control-to-an-exit-point"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">5.2 Transfer of Control to an Exit Point</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#511-overview-of-places-and-generalized-reference" class="table-of-contents__link toc-highlight">5.1.1 Overview of Places and Generalized Reference</a><ul><li><a href="#5111-evaluation-of-subforms-to-places" class="table-of-contents__link toc-highlight">5.1.1.1 Evaluation of Subforms to Places</a><ul><li><a href="#51111-examples-of-evaluation-of-subforms-to-places" class="table-of-contents__link toc-highlight">5.1.1.1.1 Examples of Evaluation of Subforms to Places</a></li></ul></li><li><a href="#5112-setf-expansions" class="table-of-contents__link toc-highlight">5.1.1.2 Setf Expansions</a><ul><li><a href="#51121-examples-of-setf-expansions" class="table-of-contents__link toc-highlight">5.1.1.2.1 Examples of Setf Expansions</a></li></ul></li></ul></li><li><a href="#512-kinds-of-places" class="table-of-contents__link toc-highlight">5.1.2 Kinds of Places</a><ul><li><a href="#5121-variable-names-as-places" class="table-of-contents__link toc-highlight">5.1.2.1 Variable Names as Places</a></li><li><a href="#5122-function-call-forms-as-places" class="table-of-contents__link toc-highlight">5.1.2.2 Function Call Forms as Places</a></li><li><a href="#5123-values-forms-as-places" class="table-of-contents__link toc-highlight">5.1.2.3 VALUES Forms as Places</a></li><li><a href="#5124-the-forms-as-places" class="table-of-contents__link toc-highlight">5.1.2.4 THE Forms as Places</a></li><li><a href="#5125-apply-forms-as-places" class="table-of-contents__link toc-highlight">5.1.2.5 APPLY Forms as Places</a></li><li><a href="#5126-setf-expansions-and-places" class="table-of-contents__link toc-highlight">5.1.2.6 Setf Expansions and Places</a></li><li><a href="#5127-macro-forms-as-places" class="table-of-contents__link toc-highlight">5.1.2.7 Macro Forms as Places</a></li><li><a href="#5128-symbol-macros-as-places" class="table-of-contents__link toc-highlight">5.1.2.8 Symbol Macros as Places</a></li><li><a href="#5129-other-compound-forms-as-places" class="table-of-contents__link toc-highlight">5.1.2.9 Other Compound Forms as Places</a></li></ul></li><li><a href="#513-treatment-of-other-macros-based-on-setf" class="table-of-contents__link toc-highlight">5.1.3 Treatment of Other Macros Based on SETF</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/cl-language-reference/docs/intro">Cl Technical Reference</a></li><li class="footer__item"><a href="https://lisp-docs.github.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">CL Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/common-lisp" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/hhk46CE" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.reddit.com/r/common_lisp" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reddit<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://irclog.tymoon.eu/libera/commonlisp" target="_blank" rel="noopener noreferrer" class="footer__link-item">IRC<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/cl-language-reference/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/lisp-docs/cl-language-reference/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 LISP Docs, MIT License. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>