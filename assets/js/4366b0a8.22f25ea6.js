"use strict";(globalThis.webpackChunkcl_language_reference=globalThis.webpackChunkcl_language_reference||[]).push([[12605],{28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>d});var r=i(96540);const t={},c=r.createContext(t);function s(e){const n=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(c.Provider,{value:n},e.children)}},61663:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>h,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>m});const r=JSON.parse('{"id":"chap-5/f-d-dictionary/defun_macro","title":"defun","description":"Expanded Reference: defun","source":"@site/docs/chap-5/f-d-dictionary/defun_macro.md","sourceDirName":"chap-5/f-d-dictionary","slug":"/chap-5/f-d-dictionary/defun_macro","permalink":"/cl-language-reference/chap-5/f-d-dictionary/defun_macro","draft":false,"unlisted":false,"editUrl":"https://github.com/lisp-docs/cl-language-reference/tree/main/docs/chap-5/f-d-dictionary/defun_macro.md","tags":[],"version":"current","lastUpdatedBy":"Daniel Nussenbaum","frontMatter":{"title":"defun"},"sidebar":"tutorialSidebar","previous":{"title":"defsetf","permalink":"/cl-language-reference/chap-5/f-d-dictionary/defsetf_macro"},"next":{"title":"destructuring-bind","permalink":"/cl-language-reference/chap-5/f-d-dictionary/destructuring-bind_macro"}}');var t=i(74848),c=i(28453);function s(e){const n={code:"code",em:"em",p:"p",pre:"pre",strong:"strong",...(0,c.R)(),...e.components},{DictionaryLink:i,GlossaryTerm:r}=n;return i||l("DictionaryLink",!0),r||l("GlossaryTerm",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"defun"})," ",(0,t.jsx)(r,{term:"macro",children:(0,t.jsx)("i",{children:"Macro"})})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Syntax:"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(i,{term:"defun",children:(0,t.jsx)("b",{children:"defun"})})," ",(0,t.jsx)(n.em,{children:"function-name lambda-list"})," [[ ",(0,t.jsx)(r,{term:"declaration",children:(0,t.jsx)("i",{children:"{declaration}"})}),"* ",(0,t.jsx)(n.em,{children:"| documentation"})," ]] ",(0,t.jsx)(r,{term:"form",children:(0,t.jsx)("i",{children:"{form}"})}),"*"]}),"\n",(0,t.jsx)(n.p,{children:"\u2192 function-name"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Arguments and Values:"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.em,{children:"function-name"}),"\u2014a ",(0,t.jsx)(r,{styled:!0,term:"function name",children:(0,t.jsx)("i",{children:"function name"})}),"."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.em,{children:"lambda-list"}),"\u2014an ",(0,t.jsx)(r,{styled:!0,term:"ordinary lambda list",children:(0,t.jsx)("i",{children:"ordinary lambda list"})}),"."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(r,{term:"declaration",children:(0,t.jsx)("i",{children:"declaration"})}),"\u2014a ",(0,t.jsx)(i,{term:"declare",children:(0,t.jsx)("b",{children:"declare"})})," ",(0,t.jsx)(r,{term:"expression",children:(0,t.jsx)("i",{children:"expression"})}),"; not evaluated."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.em,{children:"documentation"}),"\u2014a ",(0,t.jsx)(r,{term:"string",children:(0,t.jsx)("i",{children:"string"})}),"; not evaluated."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(r,{term:"form",children:(0,t.jsx)("i",{children:"forms"})}),"\u2014an ",(0,t.jsx)(r,{styled:!0,term:"implicit progn",children:(0,t.jsx)("i",{children:"implicit progn"})}),"."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.em,{children:"block-name"}),"\u2014the ",(0,t.jsx)(r,{styled:!0,term:"function block name",children:(0,t.jsx)("i",{children:"function block name"})})," of the ",(0,t.jsx)(n.em,{children:"function-name"}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Description:"})}),"\n",(0,t.jsxs)(n.p,{children:["Defines a new ",(0,t.jsx)(r,{term:"function",children:(0,t.jsx)("i",{children:"function"})})," named ",(0,t.jsx)(n.em,{children:"function-name"})," in the ",(0,t.jsx)(r,{styled:!0,term:"global environment",children:(0,t.jsx)("i",{children:"global environment"})}),". The body of the ",(0,t.jsx)(r,{term:"function",children:(0,t.jsx)("i",{children:"function"})})," defined by ",(0,t.jsx)(i,{term:"defun",children:(0,t.jsx)("b",{children:"defun"})})," consists of ",(0,t.jsx)(r,{term:"form",children:(0,t.jsx)("i",{children:"forms"})}),"; they are executed as an ",(0,t.jsx)(r,{styled:!0,term:"implicit progn",children:(0,t.jsx)("i",{children:"implicit progn"})})," when the ",(0,t.jsx)(r,{term:"function",children:(0,t.jsx)("i",{children:"function"})})," is called. ",(0,t.jsx)(i,{term:"defun",children:(0,t.jsx)("b",{children:"defun"})})," can be used to define a new ",(0,t.jsx)(r,{term:"function",children:(0,t.jsx)("i",{children:"function"})}),", to install a corrected version of an incorrect definition, to redefine an already-defined ",(0,t.jsx)(r,{term:"function",children:(0,t.jsx)("i",{children:"function"})}),", or to redefine a ",(0,t.jsx)(r,{term:"macro",children:(0,t.jsx)("i",{children:"macro"})})," as a ",(0,t.jsx)(r,{term:"function",children:(0,t.jsx)("i",{children:"function"})}),"."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(i,{term:"defun",children:(0,t.jsx)("b",{children:"defun"})})," implicitly puts a ",(0,t.jsx)(i,{term:"block",children:(0,t.jsx)("b",{children:"block"})})," named ",(0,t.jsx)(n.em,{children:"block-name"})," around the body ",(0,t.jsx)(r,{term:"form",children:(0,t.jsx)("i",{children:"forms"})})," (but not the ",(0,t.jsx)(r,{term:"form",children:(0,t.jsx)("i",{children:"forms"})})," in the ",(0,t.jsx)(n.em,{children:"lambda-list"}),") of the ",(0,t.jsx)(r,{term:"function",children:(0,t.jsx)("i",{children:"function"})})," defined."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.em,{children:"Documentation"})," is attached as a ",(0,t.jsx)(r,{styled:!0,term:"documentation string",children:(0,t.jsx)("i",{children:"documentation string"})})," to ",(0,t.jsx)(r,{term:"name",children:(0,t.jsx)("i",{children:"name"})})," (as kind ",(0,t.jsx)(i,{term:"function",children:(0,t.jsx)("b",{children:"function"})}),") and to the ",(0,t.jsx)(n.em,{children:"function object"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Evaluating ",(0,t.jsx)(i,{term:"defun",children:(0,t.jsx)("b",{children:"defun"})})," causes ",(0,t.jsx)(n.em,{children:"function-name"})," to be a global name for the ",(0,t.jsx)(r,{term:"function",children:(0,t.jsx)("i",{children:"function"})})," specified by the ",(0,t.jsx)(r,{styled:!0,term:"lambda expression",children:(0,t.jsx)("i",{children:"lambda expression"})})]}),"\n",(0,t.jsxs)(n.p,{children:["(lambda ",(0,t.jsx)(n.em,{children:"lambda-list"})]}),"\n",(0,t.jsxs)(n.p,{children:["[[ ",(0,t.jsx)(r,{term:"declaration",children:(0,t.jsx)("i",{children:"{declaration}"})}),"* ",(0,t.jsx)(n.em,{children:"| documentation"})," ]]"]}),"\n",(0,t.jsxs)(n.p,{children:["(block ",(0,t.jsx)(n.em,{children:"block-name {form}"}),"*))"]}),"\n",(0,t.jsxs)(n.p,{children:["processed in the ",(0,t.jsx)(r,{styled:!0,term:"lexical environment",children:(0,t.jsx)("i",{children:"lexical environment"})})," in which ",(0,t.jsx)(i,{term:"defun",children:(0,t.jsx)("b",{children:"defun"})})," was executed."]}),"\n",(0,t.jsx)(n.p,{children:"Data and Control"}),"\n",(0,t.jsx)(i,{term:"defun",children:(0,t.jsx)("b",{children:"defun"})}),"\n",(0,t.jsx)(n.p,{children:"(None of the arguments are evaluated at macro expansion time.)"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(i,{term:"defun",children:(0,t.jsx)("b",{children:"defun"})})," is not required to perform any compile-time side effects. In particular, ",(0,t.jsx)(i,{term:"defun",children:(0,t.jsx)("b",{children:"defun"})})," does not make the ",(0,t.jsx)(r,{term:"function",children:(0,t.jsx)("i",{children:"function"})})," definition available at compile time. An ",(0,t.jsx)(r,{term:"implementation",children:(0,t.jsx)("i",{children:"implementation"})})," may choose to store information about the ",(0,t.jsx)(r,{term:"function",children:(0,t.jsx)("i",{children:"function"})})," for the purposes of compile-time error-checking (such as checking the number of arguments on calls), or to enable the ",(0,t.jsx)(r,{term:"function",children:(0,t.jsx)("i",{children:"function"})})," to be expanded inline."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lisp",children:'(defun recur (x) \n  (when (> x 0) \n    (recur (1- x)))) \u2192 RECUR \n(defun ex (a b &optional c (d 66) &rest keys &key test (start 0)) \n  (list a b c d keys test start)) \u2192 EX \n(ex 1 2) \u2192 (1 2 NIL 66 NIL NIL 0) \n(ex 1 2 3 4 :test \u2019equal :start 50) \n\u2192 (1 2 3 4 (:TEST EQUAL :START 50) EQUAL 50) \n(ex :test 1 :start 2) \u2192 (:TEST 1 :START 2 NIL NIL 0) \n;; This function assumes its callers have checked the types of the \n;; arguments, and authorizes the compiler to build in that assumption. \n(defun discriminant (a b c) \n  (declare (number a b c)) \n  "Compute the discriminant for a quadratic equation." \n  (- (\\* b b) (\\* 4 a c))) \u2192 DISCRIMINANT \n(discriminant 1 2/3 -2) \u2192 76/9 \n;; This function assumes its callers have not checked the types of the \n;; arguments, and performs explicit type checks before making any assumptions. (defun careful-discriminant (a b c) \n"Compute the discriminant for a quadratic equation." \n(check-type a number) \n(check-type b number) \n(check-type c number) \n(locally (declare (number a b c)) \n  (- (\\* b b) (\\* 4 a c)))) \u2192 CAREFUL-DISCRIMINANT \n(careful-discriminant 1 2/3 -2) \u2192 76/9 \n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"See Also:"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(i,{term:"flet",children:(0,t.jsx)("b",{children:"flet"})}),", ",(0,t.jsx)(i,{term:"labels",children:(0,t.jsx)("b",{children:"labels"})}),", ",(0,t.jsx)(i,{term:"block",children:(0,t.jsx)("b",{children:"block"})}),", ",(0,t.jsx)(i,{term:"return-from",children:(0,t.jsx)("b",{children:"return-from"})}),", ",(0,t.jsx)(i,{term:"declare",children:(0,t.jsx)("b",{children:"declare"})}),", ",(0,t.jsx)(n.strong,{children:"documentation"}),", Section 3.1 (Evaluation), Section 3.4.1 (Ordinary Lambda Lists), Section 3.4.11 (Syntactic Interaction of Documentation Strings and Declarations)"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Notes:"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(i,{term:"return-from",children:(0,t.jsx)("b",{children:"return-from"})})," can be used to return prematurely from a ",(0,t.jsx)(r,{term:"function",children:(0,t.jsx)("i",{children:"function"})})," defined by ",(0,t.jsx)(i,{term:"defun",children:(0,t.jsx)("b",{children:"defun"})}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Additional side effects might take place when additional information (typically debugging information) about the function definition is recorded."})]})}function d(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(s,{...e})}):s(e)}function l(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}const o={title:"defun"},a="defun",h={},m=[{value:"Expanded Reference: defun",id:"expanded-reference-defun",level:2}];function x(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"defun",children:"defun"})}),"\n","\n",(0,t.jsx)(d,{}),"\n",(0,t.jsx)(n.h2,{id:"expanded-reference-defun",children:"Expanded Reference: defun"}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsx)(n.p,{children:"TODO: Please contribute to this page by adding explanations and examples"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lisp",children:"(defun )\n"})})]})}function u(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(x,{...e})}):x(e)}}}]);