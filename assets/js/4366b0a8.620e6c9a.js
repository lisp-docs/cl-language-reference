"use strict";(self.webpackChunkcl_language_reference=self.webpackChunkcl_language_reference||[]).push([[53802],{68211:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>x,frontMatter:()=>s,metadata:()=>o,toc:()=>h});var r=i(85893),c=i(11151);function t(e){const n={code:"code",em:"em",p:"p",pre:"pre",strong:"strong",...(0,c.a)(),...e.components},{ClLinks:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("ClLinks",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"defun"})," ",(0,r.jsx)(i,{term:"macro",children:(0,r.jsx)("i",{children:"Macro"})})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Syntax:"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(i,{term:"defun",children:(0,r.jsx)("b",{children:"defun"})})," ",(0,r.jsx)(n.em,{children:"function-name lambda-list"})," [[ ",(0,r.jsx)(i,{term:"declaration",children:(0,r.jsx)("i",{children:"{declaration}"})}),"* ",(0,r.jsx)(n.em,{children:"| documentation"})," ]] ",(0,r.jsx)(i,{term:"form",children:(0,r.jsx)("i",{children:"{form}"})}),"*"]}),"\n",(0,r.jsx)(n.p,{children:"\u2192 function-name"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Arguments and Values:"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.em,{children:"function-name"}),"\u2014a ",(0,r.jsx)(n.em,{children:"function name"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.em,{children:"lambda-list"}),"\u2014an ",(0,r.jsx)(n.em,{children:"ordinary lambda list"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(i,{term:"declaration",children:(0,r.jsx)("i",{children:"declaration"})}),"\u2014a ",(0,r.jsx)(i,{term:"declare",children:(0,r.jsx)("b",{children:"declare"})})," ",(0,r.jsx)(i,{term:"expression",children:(0,r.jsx)("i",{children:"expression"})}),"; not evaluated."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.em,{children:"documentation"}),"\u2014a ",(0,r.jsx)(i,{term:"string",children:(0,r.jsx)("i",{children:"string"})}),"; not evaluated."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(i,{term:"form",children:(0,r.jsx)("i",{children:"forms"})}),"\u2014an ",(0,r.jsx)(n.em,{children:"implicit progn"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.em,{children:"block-name"}),"\u2014the ",(0,r.jsx)(n.em,{children:"function block name"})," of the ",(0,r.jsx)(n.em,{children:"function-name"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Description:"})}),"\n",(0,r.jsxs)(n.p,{children:["Defines a new ",(0,r.jsx)(i,{term:"function",children:(0,r.jsx)("i",{children:"function"})})," named ",(0,r.jsx)(n.em,{children:"function-name"})," in the ",(0,r.jsx)(n.em,{children:"global environment"}),". The body of the ",(0,r.jsx)(i,{term:"function",children:(0,r.jsx)("i",{children:"function"})})," defined by ",(0,r.jsx)(i,{term:"defun",children:(0,r.jsx)("b",{children:"defun"})})," consists of ",(0,r.jsx)(i,{term:"form",children:(0,r.jsx)("i",{children:"forms"})}),"; they are executed as an ",(0,r.jsx)(n.em,{children:"implicit progn"})," when the ",(0,r.jsx)(i,{term:"function",children:(0,r.jsx)("i",{children:"function"})})," is called. ",(0,r.jsx)(i,{term:"defun",children:(0,r.jsx)("b",{children:"defun"})})," can be used to define a new ",(0,r.jsx)(i,{term:"function",children:(0,r.jsx)("i",{children:"function"})}),", to install a corrected version of an incorrect definition, to redefine an already-defined ",(0,r.jsx)(i,{term:"function",children:(0,r.jsx)("i",{children:"function"})}),", or to redefine a ",(0,r.jsx)(i,{term:"macro",children:(0,r.jsx)("i",{children:"macro"})})," as a ",(0,r.jsx)(i,{term:"function",children:(0,r.jsx)("i",{children:"function"})}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(i,{term:"defun",children:(0,r.jsx)("b",{children:"defun"})})," implicitly puts a ",(0,r.jsx)(i,{term:"block",children:(0,r.jsx)("b",{children:"block"})})," named ",(0,r.jsx)(n.em,{children:"block-name"})," around the body ",(0,r.jsx)(i,{term:"form",children:(0,r.jsx)("i",{children:"forms"})})," (but not the ",(0,r.jsx)(i,{term:"form",children:(0,r.jsx)("i",{children:"forms"})})," in the ",(0,r.jsx)(n.em,{children:"lambda-list"}),") of the ",(0,r.jsx)(i,{term:"function",children:(0,r.jsx)("i",{children:"function"})})," defined."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.em,{children:"Documentation"})," is attached as a ",(0,r.jsx)(n.em,{children:"documentation string"})," to ",(0,r.jsx)(i,{term:"name",children:(0,r.jsx)("i",{children:"name"})})," (as kind ",(0,r.jsx)(i,{term:"function",children:(0,r.jsx)("b",{children:"function"})}),") and to the ",(0,r.jsx)(n.em,{children:"function object"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Evaluating ",(0,r.jsx)(i,{term:"defun",children:(0,r.jsx)("b",{children:"defun"})})," causes ",(0,r.jsx)(n.em,{children:"function-name"})," to be a global name for the ",(0,r.jsx)(i,{term:"function",children:(0,r.jsx)("i",{children:"function"})})," specified by the ",(0,r.jsx)(n.em,{children:"lambda expression"})]}),"\n",(0,r.jsxs)(n.p,{children:["(lambda ",(0,r.jsx)(n.em,{children:"lambda-list"})]}),"\n",(0,r.jsxs)(n.p,{children:["[[ ",(0,r.jsx)(i,{term:"declaration",children:(0,r.jsx)("i",{children:"{declaration}"})}),"* ",(0,r.jsx)(n.em,{children:"| documentation"})," ]]"]}),"\n",(0,r.jsxs)(n.p,{children:["(block ",(0,r.jsx)(n.em,{children:"block-name {form}"}),"*))"]}),"\n",(0,r.jsxs)(n.p,{children:["processed in the ",(0,r.jsx)(n.em,{children:"lexical environment"})," in which ",(0,r.jsx)(i,{term:"defun",children:(0,r.jsx)("b",{children:"defun"})})," was executed."]}),"\n",(0,r.jsx)(n.p,{children:"Data and Control"}),"\n",(0,r.jsx)(i,{term:"defun",children:(0,r.jsx)("b",{children:"defun"})}),"\n",(0,r.jsx)(n.p,{children:"(None of the arguments are evaluated at macro expansion time.)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(i,{term:"defun",children:(0,r.jsx)("b",{children:"defun"})})," is not required to perform any compile-time side effects. In particular, ",(0,r.jsx)(i,{term:"defun",children:(0,r.jsx)("b",{children:"defun"})})," does not make the ",(0,r.jsx)(i,{term:"function",children:(0,r.jsx)("i",{children:"function"})})," definition available at compile time. An ",(0,r.jsx)(i,{term:"implementation",children:(0,r.jsx)("i",{children:"implementation"})})," may choose to store information about the ",(0,r.jsx)(i,{term:"function",children:(0,r.jsx)("i",{children:"function"})})," for the purposes of compile-time error-checking (such as checking the number of arguments on calls), or to enable the ",(0,r.jsx)(i,{term:"function",children:(0,r.jsx)("i",{children:"function"})})," to be expanded inline."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lisp",children:'(defun recur (x) \n  (when (> x 0) \n    (recur (1- x)))) \u2192 RECUR \n(defun ex (a b &optional c (d 66) &rest keys &key test (start 0)) \n  (list a b c d keys test start)) \u2192 EX \n(ex 1 2) \u2192 (1 2 NIL 66 NIL NIL 0) \n(ex 1 2 3 4 :test \u2019equal :start 50) \n\u2192 (1 2 3 4 (:TEST EQUAL :START 50) EQUAL 50) \n(ex :test 1 :start 2) \u2192 (:TEST 1 :START 2 NIL NIL 0) \n;; This function assumes its callers have checked the types of the \n;; arguments, and authorizes the compiler to build in that assumption. \n(defun discriminant (a b c) \n  (declare (number a b c)) \n  "Compute the discriminant for a quadratic equation." \n  (- (\\* b b) (\\* 4 a c))) \u2192 DISCRIMINANT \n(discriminant 1 2/3 -2) \u2192 76/9 \n;; This function assumes its callers have not checked the types of the \n;; arguments, and performs explicit type checks before making any assumptions. (defun careful-discriminant (a b c) \n"Compute the discriminant for a quadratic equation." \n(check-type a number) \n(check-type b number) \n(check-type c number) \n(locally (declare (number a b c)) \n  (- (\\* b b) (\\* 4 a c)))) \u2192 CAREFUL-DISCRIMINANT \n(careful-discriminant 1 2/3 -2) \u2192 76/9 \n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"See Also:"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(i,{term:"flet",children:(0,r.jsx)("b",{children:"flet"})}),", ",(0,r.jsx)(i,{term:"labels",children:(0,r.jsx)("b",{children:"labels"})}),", ",(0,r.jsx)(i,{term:"block",children:(0,r.jsx)("b",{children:"block"})}),", ",(0,r.jsx)(i,{term:"return-from",children:(0,r.jsx)("b",{children:"return-from"})}),", ",(0,r.jsx)(i,{term:"declare",children:(0,r.jsx)("b",{children:"declare"})}),", ",(0,r.jsx)(n.strong,{children:"documentation"}),", Section 3.1 (Evaluation), Section 3.4.1 (Ordinary Lambda Lists), Section 3.4.11 (Syntactic Interaction of Documentation Strings and Declarations)"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Notes:"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(i,{term:"return-from",children:(0,r.jsx)("b",{children:"return-from"})})," can be used to return prematurely from a ",(0,r.jsx)(i,{term:"function",children:(0,r.jsx)("i",{children:"function"})})," defined by ",(0,r.jsx)(i,{term:"defun",children:(0,r.jsx)("b",{children:"defun"})}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Additional side effects might take place when additional information (typically debugging information) about the function definition is recorded."})]})}function d(e={}){const{wrapper:n}={...(0,c.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}const s={title:"defun"},l="defun",o={id:"chap-5/f-d-dictionary/defun_macro",title:"defun",description:"Expanded Reference: defun",source:"@site/docs/chap-5/f-d-dictionary/defun_macro.md",sourceDirName:"chap-5/f-d-dictionary",slug:"/chap-5/f-d-dictionary/defun_macro",permalink:"/cl-language-reference/chap-5/f-d-dictionary/defun_macro",draft:!1,unlisted:!1,editUrl:"https://github.com/lisp-docs/cl-language-reference/tree/develop/docs/chap-5/f-d-dictionary/defun_macro.md",tags:[],version:"current",frontMatter:{title:"defun"},sidebar:"tutorialSidebar",previous:{title:"defsetf",permalink:"/cl-language-reference/chap-5/f-d-dictionary/defsetf_macro"},next:{title:"destructuring-bind",permalink:"/cl-language-reference/chap-5/f-d-dictionary/destructuring-bind_macro"}},a={},h=[{value:"Expanded Reference: defun",id:"expanded-reference-defun",level:2}];function m(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,c.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"defun",children:"defun"}),"\n","\n","\n",(0,r.jsx)(d,{}),"\n",(0,r.jsx)(n.h2,{id:"expanded-reference-defun",children:"Expanded Reference: defun"}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsx)(n.p,{children:"TODO: Please contribute to this page by adding explanations and examples"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lisp",children:"(defun )\n"})})]})}function x(e={}){const{wrapper:n}={...(0,c.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(m,{...e})}):m(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>s,a:()=>d});var r=i(67294);const c={},t=r.createContext(c);function d(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:d(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);