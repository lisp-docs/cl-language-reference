"use strict";(globalThis.webpackChunkcl_language_reference=globalThis.webpackChunkcl_language_reference||[]).push([[43296],{28453:(e,n,r)=>{r.d(n,{R:()=>c,x:()=>d});var s=r(96540);const i={},l=s.createContext(i);function c(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(l.Provider,{value:n},e.children)}},36061:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>h,contentTitle:()=>o,default:()=>j,frontMatter:()=>a,metadata:()=>s,toc:()=>x});const s=JSON.parse('{"id":"chap-9/j-c-dictionary/handler-case_macro","title":"handler-case","description":"Expanded Reference: handler-case","source":"@site/docs/chap-9/j-c-dictionary/handler-case_macro.md","sourceDirName":"chap-9/j-c-dictionary","slug":"/chap-9/j-c-dictionary/handler-case_macro","permalink":"/cl-language-reference/chap-9/j-c-dictionary/handler-case_macro","draft":false,"unlisted":false,"editUrl":"https://github.com/lisp-docs/cl-language-reference/tree/main/docs/chap-9/j-c-dictionary/handler-case_macro.md","tags":[],"version":"current","lastUpdatedBy":"Daniel Nussenbaum","frontMatter":{"title":"handler-case"},"sidebar":"tutorialSidebar","previous":{"title":"handler-bind","permalink":"/cl-language-reference/chap-9/j-c-dictionary/handler-bind_macro"},"next":{"title":"ignore-errors","permalink":"/cl-language-reference/chap-9/j-c-dictionary/ignore-errors_macro"}}');var i=r(74848),l=r(28453);function c(e){const n={code:"code",em:"em",p:"p",pre:"pre",strong:"strong",...(0,l.R)(),...e.components},{DictionaryLink:r,GlossaryTerm:s}=n;return r||t("DictionaryLink",!0),s||t("GlossaryTerm",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"handler-case"})," ",(0,i.jsx)(s,{styled:!0,term:"macro",children:(0,i.jsx)("i",{children:"Macro"})})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Syntax:"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(r,{styled:!0,term:"handler-case",children:(0,i.jsx)("b",{children:"handler-case"})})," ",(0,i.jsx)(s,{styled:!0,term:"expression",children:(0,i.jsx)("i",{children:"expression"})})," [[ ",(0,i.jsx)(n.em,{children:"{\u2193error-clause}"}),"* ",(0,i.jsx)(n.em,{children:"| \u2193no-error-clause"})," ]] \u2192 {result}*"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"clause::"}),"=",(0,i.jsx)(n.em,{children:"\u2193error-clause | \u2193no-error-clause"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"error-clause::"}),"=(",(0,i.jsx)(n.em,{children:"typespec"})," ([",(0,i.jsx)(n.em,{children:"var"}),"]) ",(0,i.jsx)(s,{styled:!0,term:"declaration",children:(0,i.jsx)("i",{children:"{declaration}"})}),"* ",(0,i.jsx)(s,{styled:!0,term:"form",children:(0,i.jsx)("i",{children:"{form}"})}),"*)"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"no-error-clause::"}),"=(",":no-error"," ",(0,i.jsx)(n.em,{children:"lambda-list {declaration}"}),"* ",(0,i.jsx)(s,{styled:!0,term:"form",children:(0,i.jsx)("i",{children:"{form}"})}),"*)"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Arguments and Values:"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(s,{styled:!0,term:"expression",children:(0,i.jsx)("i",{children:"expression"})}),"\u2014a ",(0,i.jsx)(s,{styled:!0,term:"form",children:(0,i.jsx)("i",{children:"form"})}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"typespec"}),"\u2014a ",(0,i.jsx)(s,{styled:!0,term:"type specifier",children:(0,i.jsx)("i",{children:"type specifier"})})," ."]}),"\n",(0,i.jsx)(r,{styled:!0,term:"handler-case",children:(0,i.jsx)("b",{children:"handler-case"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"var"}),"\u2014a ",(0,i.jsx)(n.em,{children:"variable name"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"lambda-list"}),"\u2014an ",(0,i.jsx)(s,{styled:!0,term:"ordinary lambda list",children:(0,i.jsx)("i",{children:"ordinary lambda list"})}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(s,{styled:!0,term:"declaration",children:(0,i.jsx)("i",{children:"declaration"})}),"\u2014a ",(0,i.jsx)(r,{styled:!0,term:"declare",children:(0,i.jsx)("b",{children:"declare"})})," ",(0,i.jsx)(s,{styled:!0,term:"expression",children:(0,i.jsx)("i",{children:"expression"})}),"; not evaluated."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(s,{styled:!0,term:"form",children:(0,i.jsx)("i",{children:"form"})}),"\u2014a ",(0,i.jsx)(s,{styled:!0,term:"form",children:(0,i.jsx)("i",{children:"form"})}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"results"}),"\u2014In the normal situation, the values returned are those that result from the evaluation of ",(0,i.jsx)(s,{styled:!0,term:"expression",children:(0,i.jsx)("i",{children:"expression"})}),"; in the exceptional situation when control is transferred to a ",(0,i.jsx)(n.em,{children:"clause"}),", the value of the last ",(0,i.jsx)(s,{styled:!0,term:"form",children:(0,i.jsx)("i",{children:"form"})})," in that ",(0,i.jsx)(n.em,{children:"clause"})," is returned."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Description:"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(r,{styled:!0,term:"handler-case",children:(0,i.jsx)("b",{children:"handler-case"})})," executes ",(0,i.jsx)(s,{styled:!0,term:"expression",children:(0,i.jsx)("i",{children:"expression"})})," in a ",(0,i.jsx)(s,{styled:!0,term:"dynamic environment",children:(0,i.jsx)("i",{children:"dynamic environment"})})," where various handlers are active. Each ",(0,i.jsx)(n.em,{children:"error-clause"})," specifies how to handle a ",(0,i.jsx)(s,{styled:!0,term:"condition",children:(0,i.jsx)("i",{children:"condition"})})," matching the indicated ",(0,i.jsx)(n.em,{children:"typespec"}),". A ",(0,i.jsx)(n.em,{children:"no-error-clause"})," allows the specification of a particular action if control returns normally."]}),"\n",(0,i.jsxs)(n.p,{children:["If a ",(0,i.jsx)(s,{styled:!0,term:"condition",children:(0,i.jsx)("i",{children:"condition"})})," is signaled for which there is an appropriate ",(0,i.jsx)(n.em,{children:"error-clause"})," during the execution of ",(0,i.jsx)(s,{styled:!0,term:"expression",children:(0,i.jsx)("i",{children:"expression"})})," (",(0,i.jsx)(n.em,{children:"i.e."}),", one for which (typep ",(0,i.jsx)(s,{styled:!0,term:"condition",children:(0,i.jsx)("i",{children:"condition"})})," \u2019",(0,i.jsx)(n.em,{children:"typespec"}),") returns ",(0,i.jsx)(s,{styled:!0,term:"true",children:(0,i.jsx)("i",{children:"true"})}),") and if there is no intervening handler for a ",(0,i.jsx)(s,{styled:!0,term:"condition",children:(0,i.jsx)("i",{children:"condition"})})," of that ",(0,i.jsx)(s,{styled:!0,term:"type",children:(0,i.jsx)("i",{children:"type"})}),", then control is transferred to the body of the relevant ",(0,i.jsx)(n.em,{children:"error-clause"}),". In this case, the dynamic state is unwound appropriately (so that the handlers established around the ",(0,i.jsx)(s,{styled:!0,term:"expression",children:(0,i.jsx)("i",{children:"expression"})})," are no longer active), and ",(0,i.jsx)(n.em,{children:"var"})," is bound to the ",(0,i.jsx)(s,{styled:!0,term:"condition",children:(0,i.jsx)("i",{children:"condition"})})," that had been signaled. If more than one case is provided, those cases are made accessible in parallel. That is, in"]}),"\n",(0,i.jsxs)(n.p,{children:["(handler-case ",(0,i.jsx)(s,{styled:!0,term:"form",children:(0,i.jsx)("i",{children:"form"})})]}),"\n",(0,i.jsxs)(n.p,{children:["(",(0,i.jsx)(n.em,{children:"typespec1"})," (",(0,i.jsx)(n.em,{children:"var1"}),") ",(0,i.jsx)(n.em,{children:"form1"}),")"]}),"\n",(0,i.jsxs)(n.p,{children:["(",(0,i.jsx)(n.em,{children:"typespec2"})," (",(0,i.jsx)(n.em,{children:"var2"}),") ",(0,i.jsx)(n.em,{children:"form2"}),"))"]}),"\n",(0,i.jsxs)(n.p,{children:["if the first ",(0,i.jsx)(n.em,{children:"clause"})," (containing ",(0,i.jsx)(n.em,{children:"form1"}),") has been selected, the handler for the second is no longer visible (or vice versa)."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.em,{children:"clauses"})," are searched sequentially from top to bottom. If there is ",(0,i.jsx)(s,{styled:!0,term:"type",children:(0,i.jsx)("i",{children:"type"})})," overlap between ",(0,i.jsx)(n.em,{children:"typespecs"}),", the earlier of the ",(0,i.jsx)(n.em,{children:"clauses"})," is selected."]}),"\n",(0,i.jsxs)(n.p,{children:["If ",(0,i.jsx)(n.em,{children:"var"})," is not needed, it can be omitted. That is, a ",(0,i.jsx)(n.em,{children:"clause"})," such as:"]}),"\n",(0,i.jsxs)(n.p,{children:["(",(0,i.jsx)(n.em,{children:"typespec"})," (",(0,i.jsx)(n.em,{children:"var"}),") (declare (ignore ",(0,i.jsx)(n.em,{children:"var"}),")) ",(0,i.jsx)(s,{styled:!0,term:"form",children:(0,i.jsx)("i",{children:"form"})}),")"]}),"\n",(0,i.jsxs)(n.p,{children:["can be written (",(0,i.jsx)(n.em,{children:"typespec"})," () ",(0,i.jsx)(s,{styled:!0,term:"form",children:(0,i.jsx)("i",{children:"form"})}),")."]}),"\n",(0,i.jsxs)(n.p,{children:["If there are no ",(0,i.jsx)(s,{styled:!0,term:"form",children:(0,i.jsx)("i",{children:"forms"})})," in a selected ",(0,i.jsx)(n.em,{children:"clause"}),", the case, and therefore ",(0,i.jsx)(r,{styled:!0,term:"handler-case",children:(0,i.jsx)("b",{children:"handler-case"})}),", returns ",(0,i.jsx)(r,{styled:!0,term:"nil",children:(0,i.jsx)("b",{children:"nil"})}),". If execution of ",(0,i.jsx)(s,{styled:!0,term:"expression",children:(0,i.jsx)("i",{children:"expression"})})," returns normally and no ",(0,i.jsx)(n.em,{children:"no-error-clause"})," exists, the values returned by ",(0,i.jsx)(s,{styled:!0,term:"expression",children:(0,i.jsx)("i",{children:"expression"})})," are returned by ",(0,i.jsx)(r,{styled:!0,term:"handler-case",children:(0,i.jsx)("b",{children:"handler-case"})}),". If execution of ",(0,i.jsx)(s,{styled:!0,term:"expression",children:(0,i.jsx)("i",{children:"expression"})})," returns normally and a ",(0,i.jsx)(n.em,{children:"no-error-clause"})," does exist, the values returned are used as arguments to the function described by constructing (lambda ",(0,i.jsx)(n.em,{children:"lambda-list {form}"}),"*) from the ",(0,i.jsx)(n.em,{children:"no-error-clause"}),", and the ",(0,i.jsx)(s,{styled:!0,term:"value",children:(0,i.jsx)("i",{children:"values"})})," of that function call are returned by ",(0,i.jsx)(r,{styled:!0,term:"handler-case",children:(0,i.jsx)("b",{children:"handler-case"})}),". The handlers which were established around the ",(0,i.jsx)(s,{styled:!0,term:"expression",children:(0,i.jsx)("i",{children:"expression"})})," are no longer active at the time of this call."]}),"\n",(0,i.jsx)(r,{styled:!0,term:"handler-case",children:(0,i.jsx)("b",{children:"handler-case"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lisp",children:'(defun assess-condition (condition) \n  (handler-case (signal condition) \n    (warning () "Lots of smoke, but no fire.") \n    ((or arithmetic-error control-error cell-error stream-error) \n\t(condition) \n      (format nil "~S looks especially bad." condition)) \n    (serious-condition (condition) \n      (format nil "~S looks serious." condition)) \n    (condition () "Hardly worth mentioning."))) \n\u2192 ASSESS-CONDITION \n(assess-condition (make-condition \u2019stream-error :stream \\*terminal-io\\*)) \u2192 "#<STREAM-ERROR 12352256> looks especially bad." \n(define-condition random-condition (condition) () \n  (:report (lambda (condition stream) \n\t     (declare (ignore condition)) \n\t     (princ "Yow" stream)))) \n\u2192 RANDOM-CONDITION \n(assess-condition (make-condition \u2019random-condition)) \n\u2192 "Hardly worth mentioning." \n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"See Also:"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(r,{styled:!0,term:"handler-bind",children:(0,i.jsx)("b",{children:"handler-bind"})}),", ",(0,i.jsx)(r,{styled:!0,term:"ignore-errors",children:(0,i.jsx)("b",{children:"ignore-errors"})}),", Section 9.1 (Condition System Concepts)"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Notes:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-common-lisp",children:"(handler-case form \n(*type1* (*var1*) . *body1*) \n(*type2* (*var2*) . *body2*) ...) \n"})}),"\n",(0,i.jsx)(n.p,{children:"is approximately equivalent to:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-common-lisp",children:"(block #1=#:g0001 \n(let ((#2=#:g0002 nil)) \n(tagbody \n(handler-bind ((*type1* #\u2019(lambda (temp) \n(setq #1# temp) \n(go #3=#:g0003))) \n(*type2* #\u2019(lambda (temp) \n(setq #2# temp) \n(go #4=#:g0004))) ...) \n(return-from #1# form)) \n\n#3# (return-from #1# (let ((*var1* #2#)) . *body1*)) \n\n#4# (return-from #1# (let ((*var2* #2#)) . *body2*)) ...))) \n\n(handler-case form \n(*type1 (var1)* . *body1*) \n... \n(:no-error (*varN-1 varN-2* ...) . *bodyN*)) \n"})}),"\n",(0,i.jsx)(n.p,{children:"is approximately equivalent to:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-common-lisp",children:"(block #1=#:error-return \n(multiple-value-call #\u2019(lambda (*varN-1 varN-2* ...) . *bodyN*) \n(block #2=#:normal-return \n(return-from #1# \n(handler-case (return-from #2# form) \n(*type1* (*var1*) . *body1*) ...))))) \n"})})]})}function d(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}function t(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}const a={title:"handler-case"},o="handler-case",h={},x=[{value:"Expanded Reference: handler-case",id:"expanded-reference-handler-case",level:2}];function m(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"handler-case",children:"handler-case"})}),"\n","\n",(0,i.jsx)(d,{}),"\n",(0,i.jsx)(n.h2,{id:"expanded-reference-handler-case",children:"Expanded Reference: handler-case"}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsx)(n.p,{children:"TODO: Please contribute to this page by adding explanations and examples"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-lisp",children:"(handler-case )\n"})})]})}function j(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(m,{...e})}):m(e)}}}]);