"use strict";(globalThis.webpackChunkcl_language_reference=globalThis.webpackChunkcl_language_reference||[]).push([[25164],{28453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>a});var i=s(96540);const t={},r=i.createContext(t);function c(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),i.createElement(r.Provider,{value:n},e.children)}},32311:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>y,contentTitle:()=>g,default:()=>C,frontMatter:()=>p,metadata:()=>i,toc:()=>b});const i=JSON.parse('{"id":"chap-7/h-c-changing-the-class-of-an-instance","title":"7.2 Changing the Class of an Instance","description":"7.2.1 Modifying the Structure of the Instance","source":"@site/docs/chap-7/h-c-changing-the-class-of-an-instance.md","sourceDirName":"chap-7","slug":"/chap-7/h-c-changing-the-class-of-an-instance","permalink":"/cl-language-reference/chap-7/h-c-changing-the-class-of-an-instance","draft":false,"unlisted":false,"editUrl":"https://github.com/lisp-docs/cl-language-reference/tree/main/docs/chap-7/h-c-changing-the-class-of-an-instance.md","tags":[],"version":"current","lastUpdatedBy":"Daniel Nussenbaum","frontMatter":{"title":"7.2 Changing the Class of an Instance"},"sidebar":"tutorialSidebar","previous":{"title":"7.1 Object Creation and Initialization","permalink":"/cl-language-reference/chap-7/h-b-object-creation-and-initialization"},"next":{"title":"7.3 Reinitializing an Instance","permalink":"/cl-language-reference/chap-7/h-d-reinitializing-an-instance"}}');var t=s(74848),r=s(28453);function c(e){const n={em:"em",p:"p",...(0,r.R)(),...e.components},{DictionaryLink:s,GlossaryTerm:i}=n;return s||l("DictionaryLink",!0),i||l("GlossaryTerm",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(i,{term:"function",children:(0,t.jsx)("i",{children:"function"})})," ",(0,t.jsx)(s,{term:"change-class",children:(0,t.jsx)("b",{children:"change-class"})})," can be used to change the ",(0,t.jsx)(i,{term:"class",children:(0,t.jsx)("i",{children:"class"})})," of an ",(0,t.jsx)(i,{term:"instance",children:(0,t.jsx)("i",{children:"instance"})})," from its current class, ",(0,t.jsx)(n.em,{children:"C"}),(0,t.jsx)("sub",{children:"from"}),", to a different class, ",(0,t.jsx)(n.em,{children:"C"}),(0,t.jsx)("sub",{children:"to"}),"; it changes the structure of the ",(0,t.jsx)(i,{term:"instance",children:(0,t.jsx)("i",{children:"instance"})})," to conform to the definition of the class ",(0,t.jsx)(n.em,{children:"C"}),(0,t.jsx)("sub",{children:"to"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Note that changing the ",(0,t.jsx)(i,{term:"class",children:(0,t.jsx)("i",{children:"class"})})," of an ",(0,t.jsx)(i,{term:"instance",children:(0,t.jsx)("i",{children:"instance"})})," may cause ",(0,t.jsx)(i,{term:"slot",children:(0,t.jsx)("i",{children:"slots"})})," to be added or deleted. Changing the ",(0,t.jsx)(i,{term:"class",children:(0,t.jsx)("i",{children:"class"})})," of an ",(0,t.jsx)(i,{term:"instance",children:(0,t.jsx)("i",{children:"instance"})})," does not change its identity as defined by the ",(0,t.jsx)(s,{term:"eq",children:(0,t.jsx)("b",{children:"eq"})})," function."]}),"\n",(0,t.jsxs)(n.p,{children:["When ",(0,t.jsx)(s,{term:"change-class",children:(0,t.jsx)("b",{children:"change-class"})})," is invoked on an ",(0,t.jsx)(i,{term:"instance",children:(0,t.jsx)("i",{children:"instance"})}),", a two-step updating process takes place. The first step modifies the structure of the ",(0,t.jsx)(i,{term:"instance",children:(0,t.jsx)("i",{children:"instance"})})," by adding new ",(0,t.jsx)(i,{styled:!0,term:"local slot",children:(0,t.jsx)("i",{children:"local slots"})})," and discarding ",(0,t.jsx)(i,{styled:!0,term:"local slot",children:(0,t.jsx)("i",{children:"local slots"})})," that are not specified in the new version of the ",(0,t.jsx)(i,{term:"instance",children:(0,t.jsx)("i",{children:"instance"})}),". The second step initializes the newly added ",(0,t.jsx)(i,{styled:!0,term:"local slot",children:(0,t.jsx)("i",{children:"local slots"})})," and performs any other user-defined actions. These two steps are further described in the two following sections."]})]})}function a(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}function l(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}function o(e){const n={em:"em",p:"p",...(0,r.R)(),...e.components},{GlossaryTerm:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("GlossaryTerm",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["In order to make the ",(0,t.jsx)(s,{term:"instance",children:(0,t.jsx)("i",{children:"instance"})})," conform to the class ",(0,t.jsx)(n.em,{children:"C"}),(0,t.jsx)("sub",{children:"to"}),", ",(0,t.jsx)(s,{styled:!0,term:"local slot",children:(0,t.jsx)("i",{children:"local slots"})})," specified by the class ",(0,t.jsx)(n.em,{children:"C"}),(0,t.jsx)("sub",{children:"to"})," that are not specified by the class ",(0,t.jsx)(n.em,{children:"C"}),(0,t.jsx)("sub",{children:"from"})," are added, and ",(0,t.jsx)(s,{styled:!0,term:"local slot",children:(0,t.jsx)("i",{children:"local slots"})})," not specified by the class ",(0,t.jsx)(n.em,{children:"C"}),(0,t.jsx)("sub",{children:"to"})," that are specified by the class ",(0,t.jsx)(n.em,{children:"C"}),(0,t.jsx)("sub",{children:"from"})," are discarded."]}),"\n",(0,t.jsxs)(n.p,{children:["The values of ",(0,t.jsx)(s,{styled:!0,term:"local slot",children:(0,t.jsx)("i",{children:"local slots"})})," specified by both the class ",(0,t.jsx)(n.em,{children:"C"}),(0,t.jsx)("sub",{children:"to"})," and the class ",(0,t.jsx)(n.em,{children:"C"}),(0,t.jsx)("sub",{children:"from"})," are retained. If such a ",(0,t.jsx)(s,{styled:!0,term:"local slot",children:(0,t.jsx)("i",{children:"local slot"})})," was unbound, it remains unbound."]}),"\n",(0,t.jsxs)(n.p,{children:["The values of ",(0,t.jsx)(s,{term:"slot",children:(0,t.jsx)("i",{children:"slots"})})," specified as shared in the class ",(0,t.jsx)(n.em,{children:"C"}),(0,t.jsx)("sub",{children:"from"})," and as local in the class ",(0,t.jsx)(n.em,{children:"C"}),(0,t.jsx)("sub",{children:"to"})," are retained. This first step of the update does not affect the values of any ",(0,t.jsx)(s,{styled:!0,term:"shared slot",children:(0,t.jsx)("i",{children:"shared slots"})}),"."]})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}function h(e){const n={em:"em",p:"p",strong:"strong",...(0,r.R)(),...e.components},{DictionaryLink:s,GlossaryTerm:i}=n;return s||j("DictionaryLink",!0),i||j("GlossaryTerm",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["The second step of the update initializes the newly added ",(0,t.jsx)(i,{term:"slot",children:(0,t.jsx)("i",{children:"slots"})})," and performs any other user-defined actions. This step is implemented by the generic function ",(0,t.jsx)(n.strong,{children:"update-instance-for-different-class"}),". The generic function ",(0,t.jsx)(n.strong,{children:"update-instance-for-different-class"})," is invoked by ",(0,t.jsx)(s,{term:"change-class",children:(0,t.jsx)("b",{children:"change-class"})})," after the first step of the update has been completed."]}),"\n",(0,t.jsxs)(n.p,{children:["The generic function ",(0,t.jsx)(n.strong,{children:"update-instance-for-different-class"})," is invoked on arguments computed by ",(0,t.jsx)(s,{term:"change-class",children:(0,t.jsx)("b",{children:"change-class"})}),". The first argument passed is a copy of the ",(0,t.jsx)(i,{term:"instance",children:(0,t.jsx)("i",{children:"instance"})})," being updated and is an ",(0,t.jsx)(i,{term:"instance",children:(0,t.jsx)("i",{children:"instance"})})," of the class ",(0,t.jsx)(n.em,{children:"C"}),(0,t.jsx)("sub",{children:"from"}),"; this copy has ",(0,t.jsx)(i,{styled:!0,term:"dynamic extent",children:(0,t.jsx)("i",{children:"dynamic extent"})})," within the generic function ",(0,t.jsx)(s,{term:"change-class",children:(0,t.jsx)("b",{children:"change-class"})}),". The second argument is the ",(0,t.jsx)(i,{term:"instance",children:(0,t.jsx)("i",{children:"instance"})})," as updated so far by ",(0,t.jsx)(s,{term:"change-class",children:(0,t.jsx)("b",{children:"change-class"})})," and is an ",(0,t.jsx)(i,{term:"instance",children:(0,t.jsx)("i",{children:"instance"})})," of the class ",(0,t.jsx)(n.em,{children:"C"}),(0,t.jsx)("sub",{children:"to"}),". The remaining arguments are an ",(0,t.jsx)(i,{styled:!0,term:"initialization argument list",children:(0,t.jsx)("i",{children:"initialization argument list"})}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["There is a system-supplied primary ",(0,t.jsx)(i,{term:"method",children:(0,t.jsx)("i",{children:"method"})})," for ",(0,t.jsx)(n.strong,{children:"update-instance-for-different-class"})," that has two parameter specializers, each of which is the ",(0,t.jsx)(i,{term:"class",children:(0,t.jsx)("i",{children:"class"})})," ",(0,t.jsx)(s,{term:"standard-object",children:(0,t.jsx)("b",{children:"standard-object"})}),". First this ",(0,t.jsx)(i,{term:"method",children:(0,t.jsx)("i",{children:"method"})})," checks the validity of initialization arguments and signals an error if an initialization argument is supplied that is not declared as valid. (For more information, see Section 7.1.2 (Declaring the Validity of"]}),"\n",(0,t.jsxs)(n.p,{children:["Initialization Arguments).) Then it calls the generic function ",(0,t.jsx)(s,{term:"shared-initialize",children:(0,t.jsx)("b",{children:"shared-initialize"})})," with the following arguments: the new ",(0,t.jsx)(i,{term:"instance",children:(0,t.jsx)("i",{children:"instance"})}),", a list of ",(0,t.jsx)(i,{term:"name",children:(0,t.jsx)("i",{children:"names"})})," of the newly added ",(0,t.jsx)(i,{term:"slot",children:(0,t.jsx)("i",{children:"slots"})}),", and the initialization arguments it received."]})]})}function x(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}function j(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}function m(e){const n={p:"p",strong:"strong",...(0,r.R)(),...e.components},{DictionaryLink:s,GlossaryTerm:i}=n;return s||u("DictionaryLink",!0),i||u("GlossaryTerm",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:[(0,t.jsx)(i,{term:"method",children:(0,t.jsx)("i",{children:"Methods"})})," for ",(0,t.jsx)(n.strong,{children:"update-instance-for-different-class"})," may be defined to specify actions to be taken when an ",(0,t.jsx)(i,{term:"instance",children:(0,t.jsx)("i",{children:"instance"})})," is updated. If only ",(0,t.jsx)(i,{styled:!0,term:"after method",children:(0,t.jsx)("i",{children:"after methods"})})," for ",(0,t.jsx)(n.strong,{children:"update-instance-for-different-class"})," are defined, they will be run after the system-supplied primary ",(0,t.jsx)(i,{term:"method",children:(0,t.jsx)("i",{children:"method"})})," for initialization and will not interfere with the default behavior of ",(0,t.jsx)(n.strong,{children:"update-instance-for-different-class"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(i,{term:"method",children:(0,t.jsx)("i",{children:"Methods"})})," for ",(0,t.jsx)(s,{term:"shared-initialize",children:(0,t.jsx)("b",{children:"shared-initialize"})})," may be defined to customize ",(0,t.jsx)(i,{term:"class",children:(0,t.jsx)("i",{children:"class"})})," redefinition. For more information, see Section 7.1.5 (Shared-Initialize)."]})]})}function f(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(m,{...e})}):m(e)}function u(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}const p={title:"7.2 Changing the Class of an Instance"},g="7.2 Changing the Class of an Instance",y={},b=[{value:"7.2.1 Modifying the Structure of the Instance",id:"721-modifying-the-structure-of-the-instance",level:2},{value:"7.2.2 Initializing Newly Added Local Slots",id:"722-initializing-newly-added-local-slots",level:2},{value:"7.2.3 Customizing the Change of Class of an Instance",id:"723-customizing-the-change-of-class-of-an-instance",level:2}];function w(e){const n={h1:"h1",h2:"h2",header:"header",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"72-changing-the-class-of-an-instance",children:"7.2 Changing the Class of an Instance"})}),"\n","\n",(0,t.jsx)(a,{}),"\n",(0,t.jsx)(n.h2,{id:"721-modifying-the-structure-of-the-instance",children:"7.2.1 Modifying the Structure of the Instance"}),"\n","\n",(0,t.jsx)(d,{}),"\n",(0,t.jsx)(n.h2,{id:"722-initializing-newly-added-local-slots",children:"7.2.2 Initializing Newly Added Local Slots"}),"\n","\n",(0,t.jsx)(x,{}),"\n",(0,t.jsx)(n.h2,{id:"723-customizing-the-change-of-class-of-an-instance",children:"7.2.3 Customizing the Change of Class of an Instance"}),"\n","\n",(0,t.jsx)(f,{})]})}function C(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(w,{...e})}):w(e)}}}]);