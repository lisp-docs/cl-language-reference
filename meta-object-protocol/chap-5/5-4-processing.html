<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-meta-object-protocol/chap-5/5-4-processing" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">5.4 Processing Of The User Interface Macros | Common Lisp (New) Language Reference</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://lisp-docs.github.io/cl-language-reference/img/1024px-Lisp_logo.svg.png"><meta data-rh="true" name="twitter:image" content="https://lisp-docs.github.io/cl-language-reference/img/1024px-Lisp_logo.svg.png"><meta data-rh="true" property="og:url" content="https://lisp-docs.github.io/cl-language-reference/meta-object-protocol/chap-5/5-4-processing"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="google-site-verification" content="Vzaw013_bfdKeUVG89Ch3W1zC9_vH9ID2dPB9Dz0vr0"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="5.4 Processing Of The User Interface Macros | Common Lisp (New) Language Reference"><meta data-rh="true" name="description" content="5.4.1 Compile File Processing Of The User Interface Macros"><meta data-rh="true" property="og:description" content="5.4.1 Compile File Processing Of The User Interface Macros"><link data-rh="true" rel="icon" href="/cl-language-reference/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://lisp-docs.github.io/cl-language-reference/meta-object-protocol/chap-5/5-4-processing"><link data-rh="true" rel="alternate" href="https://lisp-docs.github.io/cl-language-reference/meta-object-protocol/chap-5/5-4-processing" hreflang="en"><link data-rh="true" rel="alternate" href="https://lisp-docs.github.io/cl-language-reference/meta-object-protocol/chap-5/5-4-processing" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://C1F2Q5VM6X-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Chapter 5 - Concepts","item":"https://lisp-docs.github.io/cl-language-reference/category/chapter-5---concepts"},{"@type":"ListItem","position":2,"name":"5.4 Processing Of The User Interface Macros","item":"https://lisp-docs.github.io/cl-language-reference/meta-object-protocol/chap-5/5-4-processing"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8TJCE4NSF8"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-8TJCE4NSF8",{})</script>



<link rel="search" type="application/opensearchdescription+xml" title="Common Lisp (New) Language Reference" href="/cl-language-reference/opensearch.xml"><link rel="stylesheet" href="/cl-language-reference/assets/css/styles.afc29c90.css">
<script src="/cl-language-reference/assets/js/runtime~main.854bdcbc.js" defer="defer"></script>
<script src="/cl-language-reference/assets/js/main.0af70bd6.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://lisp-docs.github.io/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/cl-language-reference/img/logo.svg" alt="Lisp Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/cl-language-reference/img/logo.svg" alt="Lisp Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Common Lisp Docs</b></a><a href="https://lisp-docs.github.io/docs/tutorial/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Tutorial</a><a href="https://lisp-docs.github.io/cl-language-reference/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Technical Reference</a><a href="https://lisp-docs.github.io/docs/whylisp" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Why Lisp?</a><a href="https://lisp-docs.github.io/docs/howto" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Guides</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://lisp-docs.github.io/docs/contribute" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Contribute!</a><a href="https://lisp-docs.github.io/docs/help" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Getting Help</a><a href="https://lisp-docs.github.io/docs/about" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">About</a><a href="https://lisp-docs.github.io/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a><a href="https://github.com/lisp-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cl-language-reference/"><span title="Introduction" class="linkLabel_WmDU">Introduction</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-0/intro"><span title="Contents and Figures" class="categoryLinkLabel_W154">Contents and Figures</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-1/b-b-scope-purpose-and-history"><span title="1. Introduction" class="categoryLinkLabel_W154">1. Introduction</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-2/c-b-character-syntax"><span title="2. Syntax" class="categoryLinkLabel_W154">2. Syntax</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-3/d-b-evaluation"><span title="3. Evaluation and Compilation" class="categoryLinkLabel_W154">3. Evaluation and Compilation</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-4/e-b-introduction"><span title="4. Types and Classes" class="categoryLinkLabel_W154">4. Types and Classes</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-5/f-b-generalized-reference"><span title="5. Data and Control Flow" class="categoryLinkLabel_W154">5. Data and Control Flow</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-6/g-b-the-loop-facility"><span title="6. Iteration" class="categoryLinkLabel_W154">6. Iteration</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-7/h-b-object-creation-and-initialization"><span title="7. Objects" class="categoryLinkLabel_W154">7. Objects</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/category/81-structures-dictionary"><span title="8. Structures" class="categoryLinkLabel_W154">8. Structures</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-9/j-b-condition-system-concepts"><span title="9. Conditions" class="categoryLinkLabel_W154">9. Conditions</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-10/ba-b-symbol-concepts"><span title="10. Symbols" class="categoryLinkLabel_W154">10. Symbols</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-11/bb-b-package-concepts"><span title="11. Packages" class="categoryLinkLabel_W154">11. Packages</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-12/bc-b-number-concepts"><span title="12. Numbers" class="categoryLinkLabel_W154">12. Numbers</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-13/bd-b-character-concepts"><span title="13. Characters" class="categoryLinkLabel_W154">13. Characters</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-14/be-b-cons-concepts"><span title="14. Conses" class="categoryLinkLabel_W154">14. Conses</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-15/bf-b-array-concepts"><span title="15. Arrays" class="categoryLinkLabel_W154">15. Arrays</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-16/bg-b-string-concepts"><span title="16. Strings" class="categoryLinkLabel_W154">16. Strings</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-17/bh-b-sequence-concepts"><span title="17. Sequences" class="categoryLinkLabel_W154">17. Sequences</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-18/bi-b-hash-table-concepts"><span title="18. Hash Tables" class="categoryLinkLabel_W154">18. Hash Tables</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-19/bj-b-overview-of-filenames"><span title="19. Filenames" class="categoryLinkLabel_W154">19. Filenames</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-20/ca-b-file-system-concepts"><span title="20. Files" class="categoryLinkLabel_W154">20. Files</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-21/cb-b-stream-concepts"><span title="21. Streams" class="categoryLinkLabel_W154">21. Streams</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-22/cc-b-the-lisp-printer"><span title="22. Printer" class="categoryLinkLabel_W154">22. Printer</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-23/cd-b-reader-concepts"><span title="23. Reader" class="categoryLinkLabel_W154">23. Reader</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-24/ce-b-system-construction-concepts"><span title="24. System Construction" class="categoryLinkLabel_W154">24. System Construction</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-25/cf-b-the-external-environment"><span title="25. External Environment" class="categoryLinkLabel_W154">25. External Environment</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/environments"><span title="26. Environments" class="categoryLinkLabel_W154">26. Environments</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/cl-language-reference/meta-object-protocol"><span title="27. Meta Object Protocol" class="categoryLinkLabel_W154">27. Meta Object Protocol</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cl-language-reference/meta-object-protocol"><span title="Meta Object Protocol Introduction" class="linkLabel_WmDU">Meta Object Protocol Introduction</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/cl-language-reference/category/chapter-5---concepts"><span title="Chapter 5 - Concepts" class="categoryLinkLabel_W154">Chapter 5 - Concepts</span></a><button aria-label="Collapse sidebar category &#x27;Chapter 5 - Concepts&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cl-language-reference/meta-object-protocol/chap-5/introduction"><span title="5.1 Introduction" class="linkLabel_WmDU">5.1 Introduction</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cl-language-reference/meta-object-protocol/chap-5/5-2-metaobjects"><span title="5.2 Metaobjects" class="linkLabel_WmDU">5.2 Metaobjects</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cl-language-reference/meta-object-protocol/chap-5/5-3-inheritance"><span title="5.3 Inheritance Structure Of Metaobject Classes" class="linkLabel_WmDU">5.3 Inheritance Structure Of Metaobject Classes</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cl-language-reference/meta-object-protocol/chap-5/5-4-processing"><span title="5.4 Processing Of The User Interface Macros" class="linkLabel_WmDU">5.4 Processing Of The User Interface Macros</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cl-language-reference/meta-object-protocol/chap-5/5-5-subprotocols"><span title="5.5 Subprotocols" class="linkLabel_WmDU">5.5 Subprotocols</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cl-language-reference/category/chapter-6---generic-functions-and-methods"><span title="Chapter 6 - Generic Functions and Methods" class="categoryLinkLabel_W154">Chapter 6 - Generic Functions and Methods</span></a><button aria-label="Expand sidebar category &#x27;Chapter 6 - Generic Functions and Methods&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cl-language-reference/category/additional-material"><span title="Additional Material" class="categoryLinkLabel_W154">Additional Material</span></a><button aria-label="Expand sidebar category &#x27;Additional Material&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cl-language-reference/category/mop-dictionary"><span title="MOP Dictionary" class="categoryLinkLabel_W154">MOP Dictionary</span></a><button aria-label="Expand sidebar category &#x27;MOP Dictionary&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/data-structures"><span title="28. Data Structures" class="categoryLinkLabel_W154">28. Data Structures</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/portability/trivial-packages"><span title="29. Portability" class="categoryLinkLabel_W154">29. Portability</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cl-language-reference/dictionary-entries"><span title="dictionary-entries" class="linkLabel_WmDU">dictionary-entries</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/cl-language-reference/chap-26/intro"><span title="Glossary" class="categoryLinkLabel_W154">Glossary</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/cl-language-reference/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">27. Meta Object Protocol</span></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/cl-language-reference/category/chapter-5---concepts"><span>Chapter 5 - Concepts</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">5.4 Processing Of The User Interface Macros</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>5.4 Processing Of The User Interface Macros</h1></header><header><h1>Processing of the user interface macros</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="processing-of-the-user-interface-macros-1">Processing of the user interface macros<a href="#processing-of-the-user-interface-macros-1" class="hash-link" aria-label="Direct link to Processing of the user interface macros" title="Direct link to Processing of the user interface macros" translate="no">​</a></h2>
<p>A list in which the first element is one of the symbols <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defcla.htm#defclass" target="_blank" rel="noopener noreferrer" class="">defclass</a>, <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defmet.htm#defmethod" target="_blank" rel="noopener noreferrer" class="">defmethod</a>, <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defgen.htm#defgeneric" target="_blank" rel="noopener noreferrer" class="">defgeneric</a>, <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defi_4.htm#define-method-combination" target="_blank" rel="noopener noreferrer" class="">define-method-combination</a>, <code>generic-function</code>, <code>generic-flet</code> or <code>generic-labels</code>, and which has proper syntax for that macro is called a <em>user interface macro form</em>. This document provides an extended specification of the <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defcla.htm#defclass" target="_blank" rel="noopener noreferrer" class="">defclass</a>, <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defmet.htm#defmethod" target="_blank" rel="noopener noreferrer" class="">defmethod</a> and <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defgen.htm#defgeneric" target="_blank" rel="noopener noreferrer" class="">defgeneric</a> macros.</p>
<p>The user interface macros <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defcla.htm#defclass" target="_blank" rel="noopener noreferrer" class="">defclass</a>, <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defgen.htm#defgeneric" target="_blank" rel="noopener noreferrer" class="">defgeneric</a> and <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defmet.htm#defmethod" target="_blank" rel="noopener noreferrer" class="">defmethod</a> can be used not only to define metaobjects that are instances of the corresponding standard metaobject class, but also to define metaobjects that are instances of appropriate portable metaobject classes. To make it possible for portable metaobject classes to properly process the information appearing in the macro form, this document provides a limited specification of the processing of these macro forms.</p>
<p>User interface macro forms can be <code>evaluated</code> or <code>compiled</code> and later <code>executed</code>. The effect of evaluating or executing a user interface macro form is specified in terms of calls to specified functions and generic functions which provide the actual behavior of the macro. The arguments received by these functions and generic functions are derived in a specified way from the macro form.</p>
<p>Converting a user interface macro form into the arguments to the appropriate functions and generic functions has two major aspects: the conversion of the macro argument syntax into a form more suitable for later processing, and the processing of macro arguments which are forms to be evaluated (including method bodies).</p>
<p>In the syntax of the <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defcla.htm#defclass" target="_blank" rel="noopener noreferrer" class="">defclass</a> macro, the <em>initform</em> and <em>default-initarg-initial-value-form</em> arguments are forms which will be evaluated one or more times after the macro form is evaluated or executed. Special processing must be done on these arguments to ensure that the lexical scope of the forms is captured properly. This is done by building a function of zero arguments which, when called, returns the result of evaluating the form in the proper lexical environment.</p>
<p>In the syntax of the <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defmet.htm#defmethod" target="_blank" rel="noopener noreferrer" class="">defmethod</a> macro the <em>form</em>* argument is a list of forms that comprise the body of the method definition. This list of forms must be processed specially to capture the lexical scope of the macro form. In addition, the lexical functions available only in the body of methods must be introduced. To allow this and any other special processing (such as slot access optimization), a specializable protocol is used for processing the body of methods. This is discussed in <a class="" href="/cl-language-reference/meta-object-protocol/processing-method-bodies">the section ``Processing Method Bodies.&#x27;&#x27;</a></p>
<ul>
<li class=""><a class="" href="/cl-language-reference/meta-object-protocol/compile-file-processing-of-the-user-interface-macros">Compile-file processing of the user interface macros.</a></li>
<li class=""><a class="" href="/cl-language-reference/meta-object-protocol/the-defclass-macro">The <code>defclass</code> macro.</a></li>
<li class=""><a class="" href="/cl-language-reference/meta-object-protocol/the-defmethod-macro">The <code>defmethod</code> macro.</a></li>
<li class=""><a class="" href="/cl-language-reference/meta-object-protocol/processing-method-bodies">Processing method bodies.</a></li>
<li class=""><a class="" href="/cl-language-reference/meta-object-protocol/the-defgeneric-macro">The <code>defgeneric</code> macro.</a></li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="541-compile-file-processing-of-the-user-interface-macros">5.4.1 Compile File Processing Of The User Interface Macros<a href="#541-compile-file-processing-of-the-user-interface-macros" class="hash-link" aria-label="Direct link to 5.4.1 Compile File Processing Of The User Interface Macros" title="Direct link to 5.4.1 Compile File Processing Of The User Interface Macros" translate="no">​</a></h2>
<!-- -->
<header><h1>Compile-file processing of the user interface macros</h1></header>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="compile-file-processing-of-the-user-interface-macros-1">Compile-file processing of the user interface macros<a href="#compile-file-processing-of-the-user-interface-macros-1" class="hash-link" aria-label="Direct link to Compile-file processing of the user interface macros" title="Direct link to Compile-file processing of the user interface macros" translate="no">​</a></h3>
<p>It is common practice for Common Lisp compilers, while processing a file or set of files, to maintain information about the definitions that have been compiled so far. Among other things, this makes it possible to ensure that a global macro definition (<a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defmac.htm#defmacro" target="_blank" rel="noopener noreferrer" class="">defmacro</a> form) which appears in a file will affect uses of the macro later in that file. This information about the state of the compilation is called the <em>compile-file environment</em>.</p>
<p>When compiling files containing CLOS definitions, it is useful to maintain certain additional information in the compile-file environment. This can make it possible to issue various kinds of warnings (e.g., lambda list congruence) and to do various performance optimizations that would not otherwise be possible.</p>
<p>At this time, there is such significant variance in the way existing Common Lisp implementations handle compile-file environments that it would be premature to specify this mechanism. Consequently, this document specifies only the behavior of evaluating or executing user interface macro forms. What functions and generic functions are called during compile-file processing of a user interface macro form is not specified. Implementations are free to define and document their own behavior. Users may need to check implementation-specific behavior before attempting to compile certain portable programs.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="542-the-defclass-macro">5.4.2 The Defclass Macro<a href="#542-the-defclass-macro" class="hash-link" aria-label="Direct link to 5.4.2 The Defclass Macro" title="Direct link to 5.4.2 The Defclass Macro" translate="no">​</a></h2>
<!-- -->
<header><h1>The defclass macro</h1></header>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="the-defclass-macro-1">The <code>defclass</code> macro<a href="#the-defclass-macro-1" class="hash-link" aria-label="Direct link to the-defclass-macro-1" title="Direct link to the-defclass-macro-1" translate="no">​</a></h3>
<p>The evaluation or execution of a <code>defclass</code> form results in a call to the <a class="" href="/cl-language-reference/meta-object-protocol/ensure-class">ensure-class</a> function. The arguments received by <a class="" href="/cl-language-reference/meta-object-protocol/ensure-class">ensure-class</a> are derived from the <code>defclass</code> form in a defined way. The exact macro-expansion of the <code>defclass</code> form is not defined, only the relationship between the arguments to the <code>defclass</code> macro and the arguments received by the <a class="" href="/cl-language-reference/meta-object-protocol/ensure-class">ensure-class</a> function. Examples of typical <code>defclass</code> forms and sample expansions are shown in the Figures below.</p>
<hr>
<p>(defclass plane (moving-object graphics-object)
((altitude <!-- -->:initform<!-- --> 0 <!-- -->:accessor<!-- --> plane-altitude)
(speed))
(<!-- -->:default-initargs<!-- --> <!-- -->:engine<!-- --> <em>jet</em>))</p>
<p>(ensure-class &#x27;plane
&#x27;<!-- -->:direct-superclasses<!-- --> &#x27;(moving-object graphics-object)
&#x27;<!-- -->:direct-slots<!-- --> (list (list &#x27;<!-- -->:name<!-- --> &#x27;altitude
&#x27;<!-- -->:initform<!-- --> &#x27;0
&#x27;<!-- -->:initfunction<!-- --> #&#x27;(lambda () 0)
&#x27;<!-- -->:readers<!-- --> &#x27;(plane-altitude)
&#x27;<!-- -->:writers<!-- --> &#x27;((setf plane-altitude)))
(list &#x27;<!-- -->:name<!-- --> &#x27;speed))
&#x27;<!-- -->:direct-default-initargs<!-- --> (list (list &#x27;<!-- -->:engine<!-- -->
&#x27;<em>jet</em>
#&#x27;(lambda () <em>jet</em>))))</p>
<hr>
<p>A <code>defclass</code> form with standard slot and class options and an expansion of it that would result in the proper call to <a class="" href="/cl-language-reference/meta-object-protocol/ensure-class">ensure-class</a>.</p>
<hr>
<p>(defclass sst (plane)
((mach mag-step 2
locator sst-mach
locator mach-location
<!-- -->:reader<!-- --> mach-speed
<!-- -->:reader<!-- --> mach))
(<!-- -->:metaclass<!-- --> faster-class)
(another-option foo bar))</p>
<p>(ensure-class &#x27;sst
&#x27;<!-- -->:direct-superclasses<!-- --> &#x27;(plane)
&#x27;<!-- -->:direct-slots<!-- --> (list (list &#x27;<!-- -->:name<!-- --> &#x27;mach
&#x27;<!-- -->:readers<!-- --> &#x27;(mach-speed mach)
&#x27;mag-step &#x27;2
&#x27;locator &#x27;(sst-mach mach-location)))
&#x27;<!-- -->:metaclass<!-- --> &#x27;faster-class
&#x27;another-option &#x27;(foo bar))</p>
<hr>
<p>A <code>defclass</code> form with non-standard class and slot options, and an expansion of it which results in the proper call to <a class="" href="/cl-language-reference/meta-object-protocol/ensure-class">ensure-class</a>. Note that the order of the slot options has not affected the order of the properties in the canonicalized slot specification, but has affected the order of the elements in the lists which are the values of those properties.</p>
<p>The <em>name</em> argument to <code>defclass</code> becomes the value of the first argument to <a class="" href="/cl-language-reference/meta-object-protocol/ensure-class">ensure-class</a>. This is the only positional argument accepted by <a class="" href="/cl-language-reference/meta-object-protocol/ensure-class">ensure-class</a>; all other arguments are keyword arguments.</p>
<p>The <em>direct-superclasses</em> argument to <code>defclass</code> becomes the value of the <code>:direct-super-classes</code> keyword argument to <a class="" href="/cl-language-reference/meta-object-protocol/ensure-class">ensure-class</a>.</p>
<p>The <em>direct slots</em> argument to <code>defclass</code> becomes the value of the <code>:direct-slots</code> keyword argument to <a class="" href="/cl-language-reference/meta-object-protocol/ensure-class">ensure-class</a>. Special processing of this value is done to regularize the form of each slot specification and to properly capture the lexical scope of the initialization forms. This is done by converting each slot specification to a property list called a <em>canonicalized slot specification</em>. The resulting list of canonicalized slot specifications is the value of the <code>:direct-slots</code> keyword argument.</p>
<p>Canonicalized slot specifications are later used as the keyword arguments to a generic function which will, in turn, pass them to <a class="" href="/cl-language-reference/meta-object-protocol/make-instance">make-instance</a> for use as a set of initialization arguments. Each canonicalized slot specification is formed from the corresponding slot specification as follows:</p>
<ul>
<li class="">
<p>The name of the slot is the value of the <code>:name</code> property. This property appears in every canonicalized slot specification.</p>
</li>
<li class="">
<p>When the <code>:initform</code> slot option is present in the slot specification, then both the <code>:initform</code> and <code>:initfunction</code> properties are present in the canonicalized slot specification. The value of the <code>:initform</code> property is the initialization form. The value of the <code>:initfunction</code> property is a function of zero arguments which, when called, returns the result of evaluating the initialization form in its proper lexical environment.</p>
<p>If the <code>:initform</code> slot option is not present in the slot specification, then either the <code>:initfunction</code> property will not appear, or its value will be false. In such cases, the value of the <code>:initform</code> property, or whether it appears, is unspecified.</p>
</li>
<li class="">
<p>The value of the <code>:initargs</code> property is a list of the values of each <code>:initarg</code> slot option. If there are no <code>:initarg</code> slot options, then either the <code>:initargs</code> property will not appear or its value will be the empty list.</p>
</li>
<li class="">
<p>The value of the <code>:readers</code> property is a list of the values of each <code>:reader</code> and <code>:accessor</code> slot option. If there are no <code>:reader</code> or <code>:accessor</code> slot options, then either the <code>:readers</code> property will not appear or its value will be the empty list.</p>
</li>
<li class="">
<p>The value of the <code>:writers</code> property is a list of the values specified by each <code>:writer</code> and <code>:accessor</code> slot option. The value specified by a <code>:writer</code> slot option is just the value of the slot option. The value specified by an <code>:accessor</code> slot option is a two element list: the first element is the symbol <code>setf</code>, the second element is the value of the slot option. If there are no <code>:writer</code> or <code>:accessor</code> slot options, then either the <code>:writers</code> property will not appear or its value will be the empty list.</p>
</li>
<li class="">
<p>The value of the <code>:documentation</code> property is the value of the <code>:documentation</code> slot option. If there is no <code>:documentation</code> slot option, then either the <code>:documentation</code> property will not appear or its value will be false.</p>
</li>
<li class="">
<p>All other slot options appear as the values of properties with the same name as the slot option. Note that this includes not only the remaining standard slot options (<code>:allocation</code> and <code>:type</code>), but also any other options and values appearing in the slot specification. If one of these slot options appears more than once, the value of the property will be a list of the specified values.</p>
</li>
<li class="">
<p>An implementation is free to add additional properties to the canonicalized slot specification provided these are not symbols accessible in the <code>common-lisp-user</code> package, or exported by any package defined in the ANSI Common Lisp standard.</p>
</li>
</ul>
<p>Returning to the correspondence between arguments to the <code>defclass</code> macro and the arguments received by the <a class="" href="/cl-language-reference/meta-object-protocol/ensure-class">ensure-class</a> function:</p>
<p>The <em>default initargs</em> class option, if it is present in the <code>defclass</code> form, becomes the value of the <code>:direct-default-initargs</code> keyword argument to <a class="" href="/cl-language-reference/meta-object-protocol/ensure-class">ensure-class</a>. Special processing of this value is done to properly capture the lexical scope of the default value forms. This is done by converting each default initarg in the class option into a <em>canonicalized default initarg</em>. The resulting list of canonicalized default initargs is the value of the <code>:direct-default-initargs</code> keyword argument to <a class="" href="/cl-language-reference/meta-object-protocol/ensure-class">ensure-class</a>.</p>
<p>A canonicalized default initarg is a list of three elements. The first element is the name; the second is the actual form itself; and the third is a function of zero arguments which, when called, returns the result of evaluating the default value form in its proper lexical environment.</p>
<p>The <em>metaclass</em> class option, if it is present in the <code>defclass</code> form, becomes the value of the <code>:metaclass</code> keyword argument to <a class="" href="/cl-language-reference/meta-object-protocol/ensure-class">ensure-class</a>.</p>
<p>The <em>documentation</em> class option, if it is present in the <code>defclass</code> form, becomes the value of the <code>:documentation</code> keyword argument to <a class="" href="/cl-language-reference/meta-object-protocol/ensure-class">ensure-class</a>.</p>
<p>Any other class options become the value of keyword arguments with the same name. The value of the keyword argument is the tail of the class option. An error is signaled if any class option appears more than once in the <code>defclass</code> form.</p>
<p>In the call to <a class="" href="/cl-language-reference/meta-object-protocol/ensure-class">ensure-class</a>, every element of its arguments appears in the same left-to-right order as the corresponding element of the <code>defclass</code> form, except that the order of the properties of canonicalized slot specifications is unspecified. The values of properties in canonicalized slot specifications do follow this ordering requirement. Other ordering relationships in the keyword arguments to <a class="" href="/cl-language-reference/meta-object-protocol/ensure-class">ensure-class</a> are unspecified.</p>
<p>The result of the call to <a class="" href="/cl-language-reference/meta-object-protocol/ensure-class">ensure-class</a> is returned as the result of evaluating or executing the <code>defclass</code> form.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="543-the-defmethod-macro">5.4.3 The Defmethod Macro<a href="#543-the-defmethod-macro" class="hash-link" aria-label="Direct link to 5.4.3 The Defmethod Macro" title="Direct link to 5.4.3 The Defmethod Macro" translate="no">​</a></h2>
<!-- -->
<header><h1>The defmethod macro</h1></header>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="the-defmethod-macro-1">The <code>defmethod</code> macro<a href="#the-defmethod-macro-1" class="hash-link" aria-label="Direct link to the-defmethod-macro-1" title="Direct link to the-defmethod-macro-1" translate="no">​</a></h3>
<p>The evaluation or execution of a <code>defmethod</code> form requires first that the body of the method be converted to a method function. This process is described in the next section. The result of this process is a method function and a set of additional initialization arguments to be used when creating the new method. Given these two values, the evaluation or execution of a <code>defmethod</code> form proceeds in three steps. The first step ensures the existence of a generic function with the specified name. This is done by calling the function <a class="" href="/cl-language-reference/meta-object-protocol/ensure-generic-function">ensure-generic-function</a>. The first argument in this call is the generic function name specified in the <code>defmethod</code> form. The second step is the creation of the new method metaobject by calling <a class="" href="/cl-language-reference/meta-object-protocol/make-instance">make-instance</a>. The class of the new method metaobject is determined by calling <a class="" href="/cl-language-reference/meta-object-protocol/generic-function-method-class">generic-function-method-class</a> on the result of the call to <a class="" href="/cl-language-reference/meta-object-protocol/ensure-generic-function">ensure-generic-function</a> from the first step. The initialization arguments received by the call to <a class="" href="/cl-language-reference/meta-object-protocol/make-instance">make-instance</a> are as follows:</p>
<ul>
<li class="">The value of the <code>qualifiers</code> initialization argument is a list of the qualifiers which appeared in the <code>defmethod</code> form. No special processing is done on these values. The order of the elements of this list is the same as in the <code>defmethod</code> form.</li>
<li class="">The value of the <code>lambda-list</code> initialization argument is the unspecialized lambda list from the <code>defmethod</code> form.</li>
<li class="">The value of the <code>specializers</code> initialization argument is a list of the specializers for the method. For specializers which are classes, the specializer is the class metaobject itself. In the case of <code>eql</code> specializers, it will be an <a class="" href="/cl-language-reference/meta-object-protocol/class-eql-specializer">eql-specializer</a> metaobject obtained by calling <a class="" href="/cl-language-reference/meta-object-protocol/intern-eql-specializer">intern-eql-specializer</a> on the result of evaluating the <code>eql</code> specializer form in the lexical environment of the <code>defmethod</code> form.</li>
<li class="">The value of the <code>function</code> initialization argument is the method function.</li>
<li class="">The value of the <code>declarations</code> initialization argument is a list of the declarations from the <code>defmethod</code> form. If there are no declarations in the macro form, this initialization argument either doesn&#x27;t appear, or appears with a value of the empty list.</li>
<li class="">The value of the <code>documentation</code> initialization argument is the documentation string from the <code>defmethod</code> form. If there is no documentation string in the macro form this initialization argument either doesn&#x27;t appear, or appears with a value of false.</li>
<li class="">Any other initialization argument produced in conjunction with the method function are also included.</li>
<li class="">The implementation is free to include additional initialization arguments provided these are not symbols accessible in the <code>common-lisp-user</code> package, or exported by any package defined in the ANSI Common Lisp standard.</li>
</ul>
<p>In the third step, <a class="" href="/cl-language-reference/meta-object-protocol/add-method">add-method</a> is called to add the newly created method to the set of methods associated with the generic function metaobject. The result of the call to <a class="" href="/cl-language-reference/meta-object-protocol/add-method">add-method</a> is returned as the result of evaluating or executing the <code>defmethod</code> form. An example showing a typical <code>defmethod</code> form and a sample expansion is shown in <a class="" href="/cl-language-reference/meta-object-protocol/fig-defmethod-1">this figure</a>. The processing of the method body for this method is shown in <a class="" href="/cl-language-reference/meta-object-protocol/fig-defmethod-2">this figure</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="544-processing-method-bodies">5.4.4 Processing Method Bodies<a href="#544-processing-method-bodies" class="hash-link" aria-label="Direct link to 5.4.4 Processing Method Bodies" title="Direct link to 5.4.4 Processing Method Bodies" translate="no">​</a></h2>
<!-- -->
<header><h1>Processing method bodies</h1></header>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="processing-method-bodies-1">Processing method bodies<a href="#processing-method-bodies-1" class="hash-link" aria-label="Direct link to Processing method bodies" title="Direct link to Processing method bodies" translate="no">​</a></h3>
<p>Before a method can be created, the list of forms comprising the method body must be converted to a method function. This conversion is a two step process.</p>
<p><strong>Note:</strong></p>
<p>The body of methods can also appear in the <code>:initial-methods</code> option of <a class="" href="/cl-language-reference/meta-object-protocol/the-defgeneric-macro">defgeneric</a> forms. Initial methods are not considered by any of the protocols specified in this document.</p>
<p>The first step occurs during macro-expansion of the macro form. In this step, the method lambda list, declarations and body are converted to a lambda expression called a <em>method lambda</em>. This conversion is based on information associated with the generic function definition in effect at the time the macro form is expanded.</p>
<p>The generic function definition is obtained by calling <a class="" href="/cl-language-reference/meta-object-protocol/ensure-generic-function">ensure-generic-function</a> with a first argument of the generic function name specified in the macro form. The <code>:lambda-list</code> keyword argument is not passed in this call.</p>
<p>Given the generic function, production of the method lambda proceeds by calling <a class="" href="/cl-language-reference/meta-object-protocol/make-method-lambda">make-method-lambda</a>. The first argument in this call is the generic function obtained as described above. The second argument is the result of calling <a class="" href="/cl-language-reference/meta-object-protocol/class-prototype">class-prototype</a> on the result of calling <a class="" href="/cl-language-reference/meta-object-protocol/generic-function-method-class">generic-function-method-class</a> on the generic function. The third argument is a lambda expression formed from the method lambda list, declarations and body. The fourth argument is the macro-expansion environment of the macro form; this is the value of the <code>&amp;environment</code> argument to the <a class="" href="/cl-language-reference/meta-object-protocol/the-defmethod-macro">defmethod</a> macro.</p>
<p>The generic function <a class="" href="/cl-language-reference/meta-object-protocol/make-method-lambda">make-method-lambda</a> returns two values. The first is the method lambda itself. The second is a list of initialization arguments and values. These are included in the initialization arguments when the method is created.</p>
<p>In the second step, the method lambda is converted to a function which properly captures the lexical scope of the macro form. This is done by having the method lambda appear in the macro-expansion as the argument of the <a href="http://www.lispworks.com/documentation/HyperSpec/Body/s_fn.htm" target="_blank" rel="noopener noreferrer" class="">function</a> special form. During the subsequent evaluation of the macro-expansion, the result of the <a href="http://www.lispworks.com/documentation/HyperSpec/Body/s_fn.htm" target="_blank" rel="noopener noreferrer" class="">function</a> special form is the methodfunction.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="545-the-defgeneric-macro">5.4.5 The Defgeneric Macro<a href="#545-the-defgeneric-macro" class="hash-link" aria-label="Direct link to 5.4.5 The Defgeneric Macro" title="Direct link to 5.4.5 The Defgeneric Macro" translate="no">​</a></h2>
<!-- -->
<header><h1>The defgeneric macro</h1></header>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="the-defgeneric-macro-1">The <code>defgeneric</code> macro<a href="#the-defgeneric-macro-1" class="hash-link" aria-label="Direct link to the-defgeneric-macro-1" title="Direct link to the-defgeneric-macro-1" translate="no">​</a></h3>
<p>The evaluation or execution of a <code>defgeneric</code> form results in a call to the <a class="" href="/cl-language-reference/meta-object-protocol/ensure-generic-function">ensure-generic-function</a> function. The arguments received by <a class="" href="/cl-language-reference/meta-object-protocol/ensure-generic-function">ensure-generic-function</a> are derived from the <code>defgeneric</code> form in a defined way. As with <a class="" href="/cl-language-reference/meta-object-protocol/the-defclass-macro">defclass</a> and <a class="" href="/cl-language-reference/meta-object-protocol/the-defmethod-macro">defmethod</a>, the exact macro-expansion of the <code>defgeneric</code> form is not defined, only the relationship between the arguments to the macro and the arguments received by <a class="" href="/cl-language-reference/meta-object-protocol/ensure-generic-function">ensure-generic-function</a>.</p>
<ul>
<li class="">
<p>The <em>function-name</em> argument to <code>defgeneric</code> becomes the first argument to <a class="" href="/cl-language-reference/meta-object-protocol/ensure-generic-function">ensure-generic-function</a>. This is the only positional argument accepted by <a class="" href="/cl-language-reference/meta-object-protocol/ensure-generic-function">ensure-generic-function</a>; all other arguments are keyword arguments.</p>
</li>
<li class="">
<p>The <em>lambda-list</em> argument to <code>defgeneric</code> becomes the value of the <code>:lambda-list</code> keyword argument to <a class="" href="/cl-language-reference/meta-object-protocol/ensure-generic-function">ensure-generic-function</a>.</p>
</li>
<li class="">
<p>For each of the options <code>:argument-precedence-order</code>, <code>:documentation</code>, <code>:generic-function-class</code> and <code>:method-class</code>, the value of the option becomes the value of the keyword argument with the same name. If the option does not appear in the macro form, the keyword argument does not appear in the resulting call to <a class="" href="/cl-language-reference/meta-object-protocol/ensure-generic-function">ensure-generic-function</a>.</p>
</li>
<li class="">
<p>For the option <code>declare</code>, the list of declarations becomes the value of the <code>:declarations</code> keyword argument. If the <code>declare</code> option does not appear in the macro form, the <code>:declarations</code> keyword argument does not appear in the call to <a class="" href="/cl-language-reference/meta-object-protocol/ensure-generic-function">ensure-generic-function</a>.</p>
</li>
<li class="">
<p>The handling of the <code>:method-combination</code> option is not specified.</p>
</li>
</ul>
<p>The result of the call to <a class="" href="/cl-language-reference/meta-object-protocol/ensure-generic-function">ensure-generic-function</a> is returned as the result of evaluating or executing the <code>defgeneric</code> form.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/lisp-docs/cl-language-reference/tree/main/docs/meta-object-protocol/chap-5/5-4-processing.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> by <b>Daniel Nussenbaum</b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cl-language-reference/meta-object-protocol/chap-5/5-3-inheritance"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">5.3 Inheritance Structure Of Metaobject Classes</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cl-language-reference/meta-object-protocol/chap-5/5-5-subprotocols"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">5.5 Subprotocols</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#processing-of-the-user-interface-macros-1" class="table-of-contents__link toc-highlight">Processing of the user interface macros</a></li><li><a href="#541-compile-file-processing-of-the-user-interface-macros" class="table-of-contents__link toc-highlight">5.4.1 Compile File Processing Of The User Interface Macros</a><ul><li><a href="#compile-file-processing-of-the-user-interface-macros-1" class="table-of-contents__link toc-highlight">Compile-file processing of the user interface macros</a></li></ul></li><li><a href="#542-the-defclass-macro" class="table-of-contents__link toc-highlight">5.4.2 The Defclass Macro</a><ul><li><a href="#the-defclass-macro-1" class="table-of-contents__link toc-highlight">The <code>defclass</code> macro</a></li></ul></li><li><a href="#543-the-defmethod-macro" class="table-of-contents__link toc-highlight">5.4.3 The Defmethod Macro</a><ul><li><a href="#the-defmethod-macro-1" class="table-of-contents__link toc-highlight">The <code>defmethod</code> macro</a></li></ul></li><li><a href="#544-processing-method-bodies" class="table-of-contents__link toc-highlight">5.4.4 Processing Method Bodies</a><ul><li><a href="#processing-method-bodies-1" class="table-of-contents__link toc-highlight">Processing method bodies</a></li></ul></li><li><a href="#545-the-defgeneric-macro" class="table-of-contents__link toc-highlight">5.4.5 The Defgeneric Macro</a><ul><li><a href="#the-defgeneric-macro-1" class="table-of-contents__link toc-highlight">The <code>defgeneric</code> macro</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://lisp-docs.github.io/docs/tutorial" target="_blank" rel="noopener noreferrer" class="footer__link-item">Common Lisp Tutorial</a></li><li class="footer__item"><a href="https://lisp-docs.github.io/cl-language-reference/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Common Lisp Technical Reference</a></li><li class="footer__item"><a href="https://lisp-docs.github.io/docs/help" target="_blank" rel="noopener noreferrer" class="footer__link-item">Help</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/common-lisp" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discord.gg/hhk46CE" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.reddit.com/r/common_lisp" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reddit<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://irclog.tymoon.eu/libera/commonlisp" target="_blank" rel="noopener noreferrer" class="footer__link-item">IRC<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://lisp-docs.github.io/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/lisp-docs/lisp-docs.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Tutorial and General Content GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/lisp-docs/cl-language-reference/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Technical Reference GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://lisp-docs.github.io/docs/contribute" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contribute to the Docs</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Common Lisp Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://lisp-docs.github.io/docs/about" target="_blank" rel="noopener noreferrer" class="footer__link-item">About</a></li><li class="footer__item"><a href="https://lisp-docs.github.io/docs/whylisp" target="_blank" rel="noopener noreferrer" class="footer__link-item">Why Lisp</a></li><li class="footer__item"><a href="https://lisp-docs.github.io/docs/getting-started" target="_blank" rel="noopener noreferrer" class="footer__link-item">Getting Started</a></li><li class="footer__item"><a href="https://lisp-docs.github.io/docs/faq" target="_blank" rel="noopener noreferrer" class="footer__link-item">FAQ</a></li><li class="footer__item"><a href="https://lisp-docs.github.io/docs/help" target="_blank" rel="noopener noreferrer" class="footer__link-item">Getting Help</a></li><li class="footer__item"><a href="https://lisp-docs.github.io/docs/howto" target="_blank" rel="noopener noreferrer" class="footer__link-item">How To Guides</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Common Lisp Docs, MIT License (see GitHub Repo).</div></div></div></footer></div>
</body>
</html>