<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-meta-object-protocol/chap-5/5-5-subprotocols" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">5.5 Subprotocols | Common Lisp (New) Language Reference</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://lisp-docs.github.io/cl-language-reference/img/1024px-Lisp_logo.svg.png"><meta data-rh="true" name="twitter:image" content="https://lisp-docs.github.io/cl-language-reference/img/1024px-Lisp_logo.svg.png"><meta data-rh="true" property="og:url" content="https://lisp-docs.github.io/cl-language-reference/meta-object-protocol/chap-5/5-5-subprotocols"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="google-site-verification" content="Vzaw013_bfdKeUVG89Ch3W1zC9_vH9ID2dPB9Dz0vr0"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="5.5 Subprotocols | Common Lisp (New) Language Reference"><meta data-rh="true" name="description" content="5.5.1 Metaobject Initialization Protocols"><meta data-rh="true" property="og:description" content="5.5.1 Metaobject Initialization Protocols"><link data-rh="true" rel="icon" href="/cl-language-reference/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://lisp-docs.github.io/cl-language-reference/meta-object-protocol/chap-5/5-5-subprotocols"><link data-rh="true" rel="alternate" href="https://lisp-docs.github.io/cl-language-reference/meta-object-protocol/chap-5/5-5-subprotocols" hreflang="en"><link data-rh="true" rel="alternate" href="https://lisp-docs.github.io/cl-language-reference/meta-object-protocol/chap-5/5-5-subprotocols" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://C1F2Q5VM6X-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8TJCE4NSF8"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-8TJCE4NSF8",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Common Lisp (New) Language Reference" href="/cl-language-reference/opensearch.xml"><link rel="stylesheet" href="/cl-language-reference/assets/css/styles.f13b59fe.css">
<script src="/cl-language-reference/assets/js/runtime~main.336dca55.js" defer="defer"></script>
<script src="/cl-language-reference/assets/js/main.08c60752.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://lisp-docs.github.io/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/cl-language-reference/img/logo.svg" alt="Lisp Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/cl-language-reference/img/logo.svg" alt="Lisp Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Common Lisp Docs</b></a><a href="https://lisp-docs.github.io/docs/tutorial/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Tutorial</a><a href="https://lisp-docs.github.io/cl-language-reference/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Technical Reference</a><a href="https://lisp-docs.github.io/docs/whylisp" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Why Lisp?</a><a href="https://lisp-docs.github.io/docs/howto" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Guides</a></div><div class="navbar__items navbar__items--right"><a href="https://lisp-docs.github.io/docs/contribute" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Contribute!</a><a href="https://lisp-docs.github.io/docs/help" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Getting Help</a><a href="https://lisp-docs.github.io/docs/about" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">About</a><a href="https://lisp-docs.github.io/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a><a href="https://github.com/lisp-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cl-language-reference/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-0/intro">Contents and Figures</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-1/b-b-scope-purpose-and-history">1. Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-2/c-b-character-syntax">2. Syntax</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-3/d-b-evaluation">3. Evaluation and Compilation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-4/e-b-introduction">4. Types and Classes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-5/f-b-generalized-reference">5. Data and Control Flow</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-6/g-b-the-loop-facility">6. Iteration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-7/h-b-object-creation-and-initialization">7. Objects</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/category/81-structures-dictionary">8. Structures</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-9/j-b-condition-system-concepts">9. Conditions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-10/ba-b-symbol-concepts">10. Symbols</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-11/bb-b-package-concepts">11. Packages</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-12/bc-b-number-concepts">12. Numbers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-13/bd-b-character-concepts">13. Characters</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-14/be-b-cons-concepts">14. Conses</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-15/bf-b-array-concepts">15. Arrays</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-16/bg-b-string-concepts">16. Strings</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-17/bh-b-sequence-concepts">17. Sequences</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-18/bi-b-hash-table-concepts">18. Hash Tables</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-19/bj-b-overview-of-filenames">19. Filenames</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-20/ca-b-file-system-concepts">20. Files</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-21/cb-b-stream-concepts">21. Streams</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-22/cc-b-the-lisp-printer">22. Printer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-23/cd-b-reader-concepts">23. Reader</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-24/ce-b-system-construction-concepts">24. System Construction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-25/cf-b-the-external-environment">25. External Environment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/environments">26. Environments</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/cl-language-reference/meta-object-protocol">27. Meta Object Protocol</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cl-language-reference/meta-object-protocol">Meta Object Protocol Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/cl-language-reference/category/chapter-5---concepts">Chapter 5 - Concepts</a><button aria-label="Collapse sidebar category &#x27;Chapter 5 - Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cl-language-reference/meta-object-protocol/chap-5/introduction">5.1 Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cl-language-reference/meta-object-protocol/chap-5/5-2-metaobjects">5.2 Metaobjects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cl-language-reference/meta-object-protocol/chap-5/5-3-inheritance">5.3 Inheritance Structure Of Metaobject Classes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cl-language-reference/meta-object-protocol/chap-5/5-4-processing">5.4 Processing Of The User Interface Macros</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cl-language-reference/meta-object-protocol/chap-5/5-5-subprotocols">5.5 Subprotocols</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/cl-language-reference/category/chapter-6---generic-functions-and-methods">Chapter 6 - Generic Functions and Methods</a><button aria-label="Expand sidebar category &#x27;Chapter 6 - Generic Functions and Methods&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/cl-language-reference/category/additional-material">Additional Material</a><button aria-label="Expand sidebar category &#x27;Additional Material&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/cl-language-reference/category/mop-dictionary">MOP Dictionary</a><button aria-label="Expand sidebar category &#x27;MOP Dictionary&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/data-structures">28. Data Structures</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/portability/trivial-packages">29. Portability</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cl-language-reference/dictionary-entries">dictionary-entries</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/cl-language-reference/chap-26/intro">Glossary</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/cl-language-reference/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">27. Meta Object Protocol</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/cl-language-reference/category/chapter-5---concepts"><span itemprop="name">Chapter 5 - Concepts</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">5.5 Subprotocols</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>5.5 Subprotocols</h1></header><h1>Subprotocols</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="subprotocols-1">Subprotocols<a href="#subprotocols-1" class="hash-link" aria-label="Direct link to Subprotocols" title="Direct link to Subprotocols">​</a></h2>
<p>This section provides an overview of the Metaobject Protocols. The detailed behavior of each function, generic function and macro in the Metaobject Protocol is presented in <a href="/cl-language-reference/meta-object-protocol/chapter-6">Chapter 6</a> . The remainder of this chapter is intended to emphasize connections among the parts of the Metaobject Protocol, and to provide some examples of the kinds of specializations and extensions the protocols are designed to support.</p>
<ul>
<li><a href="/cl-language-reference/meta-object-protocol/metaobject-initialization-protocols">Metaobject initialization protocols.</a>
<ul>
<li><a href="/cl-language-reference/meta-object-protocol/initialization-of-class-metaobjects">Initialization of class metaobjects</a></li>
<li><a href="/cl-language-reference/meta-object-protocol/reinitialization-of-class-metaobjects">Reinitialization of class metaobjects</a></li>
<li><a href="/cl-language-reference/meta-object-protocol/initialization-of-generic-function-and-method-metaobjects">Initialization of generic function and method metaobjects</a></li>
</ul>
</li>
<li><a href="/cl-language-reference/meta-object-protocol/class-finalization-protocol">Class finalization protocol.</a></li>
<li><a href="/cl-language-reference/meta-object-protocol/instance-structure-protocol">Instance structure protocol.</a></li>
<li><a href="/cl-language-reference/meta-object-protocol/funcallable-instances">Funcallable instances.</a></li>
<li><a href="/cl-language-reference/meta-object-protocol/generic-function-invocation-protocol">Generic function invocation protocol.</a></li>
<li><a href="/cl-language-reference/meta-object-protocol/dependent-maintenance-protocol">Dependent maintenance protocol.</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="551-metaobject-initialization-protocols">5.5.1 Metaobject Initialization Protocols<a href="#551-metaobject-initialization-protocols" class="hash-link" aria-label="Direct link to 5.5.1 Metaobject Initialization Protocols" title="Direct link to 5.5.1 Metaobject Initialization Protocols">​</a></h2>
<!-- -->
<h1>Metaobject initialization protocols</h1>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="metaobject-initialization-protocols-1">Metaobject initialization protocols<a href="#metaobject-initialization-protocols-1" class="hash-link" aria-label="Direct link to Metaobject initialization protocols" title="Direct link to Metaobject initialization protocols">​</a></h3>
<p>Like other objects, metaobjects can be created by calling <a href="/cl-language-reference/meta-object-protocol/make-instance">make-instance</a>. The initialization arguments passed to <a href="/cl-language-reference/meta-object-protocol/make-instance">make-instance</a> are used to initialize the metaobject in the usual way. The set of legal initialization arguments, and their interpretation, depends on the kind of metaobject being created. Implementations and portable programs are free to extend the set of legal initialization arguments. Detailed information about the initialization of each kind of metaobject are provided in <a href="/cl-language-reference/meta-object-protocol/chapter-6">Chapter 6</a>; this section provides an overview and examples of this behavior.</p>
<ul>
<li><a href="/cl-language-reference/meta-object-protocol/initialization-of-class-metaobjects">Initialization of class metaobjects</a></li>
<li><a href="/cl-language-reference/meta-object-protocol/reinitialization-of-class-metaobjects">Reinitialization of class metaobjects</a></li>
<li><a href="/cl-language-reference/meta-object-protocol/initialization-of-generic-function-and-method-metaobjects">Initialization of generic function and method metaobjects</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5511-initialization-of-class-metaobjects">5.5.1.1 Initialization Of Class Metaobjects<a href="#5511-initialization-of-class-metaobjects" class="hash-link" aria-label="Direct link to 5.5.1.1 Initialization Of Class Metaobjects" title="Direct link to 5.5.1.1 Initialization Of Class Metaobjects">​</a></h3>
<!-- -->
<h1>Initialization of Class Metaobjects</h1>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="initialization-of-class-metaobjects-1">Initialization of Class Metaobjects<a href="#initialization-of-class-metaobjects-1" class="hash-link" aria-label="Direct link to Initialization of Class Metaobjects" title="Direct link to Initialization of Class Metaobjects">​</a></h4>
<p>Class metaobjects created with <a href="/cl-language-reference/meta-object-protocol/make-instance">make-instance</a>{#make-instance-1} are usually <em>anonymous</em>; that is, they have no proper name. An anonymous class metaobject can be given a proper name using <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_find_c.htm#find-class" target="_blank" rel="noopener noreferrer">(setf find-class)</a> and <a href="/cl-language-reference/meta-object-protocol/setf-class-name">(setf class-name)</a>.</p>
<p>When a class metaobject is created with <a href="/cl-language-reference/meta-object-protocol/make-instance">make-instance</a>, it is initialized in the usual way. The initialization arguments passed to <a href="/cl-language-reference/meta-object-protocol/make-instance">make-instance</a> are use to establish the definition of the class. Each initialization argument is checked for errors and associated with the class metaobject. The initialization arguments correspond roughly to the arguments accepted by the <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defcla.htm#defclass" target="_blank" rel="noopener noreferrer">defclass</a> macro, and more closely to the arguments accepted by the <a href="/cl-language-reference/meta-object-protocol/ensure-class">ensure-class</a> function.</p>
<p>Some class metaobject classes allow their instances to be redefined. When permissible, this is done by calling <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_reinit.htm#reinitialize-instance" target="_blank" rel="noopener noreferrer">reinitialize-instance</a>. This is discussed in the next section.</p>
<p>An example of creating an anonymous class directly using <a href="/cl-language-reference/meta-object-protocol/make-instance">make-instance</a> follows:</p>
<div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">flet</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">zero</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">propellor</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> *propellor*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">make-instance</span><span class="token plain"> </span><span class="token quoted-symbol variable symbol" style="color:#36acaa">&#x27;standard-class</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token lisp-property property" style="color:#36acaa">:name</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">&#x27;(</span><span class="token car">my-class</span><span class="token plain"> foo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token lisp-property property" style="color:#36acaa">:direct-superclasses</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">list</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">find-class</span><span class="token plain"> </span><span class="token quoted-symbol variable symbol" style="color:#36acaa">&#x27;plane</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                   another-anonymous-class</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token lisp-property property" style="color:#36acaa">:direct-slots</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">`(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token lisp-property property" style="color:#36acaa">:name</span><span class="token plain"> x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         </span><span class="token lisp-property property" style="color:#36acaa">:initform</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         </span><span class="token lisp-property property" style="color:#36acaa">:initfunction</span><span class="token plain"> ,</span><span class="token quoted-symbol variable symbol" style="color:#36acaa">#&#x27;zero</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         </span><span class="token lisp-property property" style="color:#36acaa">:initargs</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token lisp-property property" style="color:#36acaa">:x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         </span><span class="token lisp-property property" style="color:#36acaa">:readers</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">position-x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         </span><span class="token lisp-property property" style="color:#36acaa">:writers</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">setf</span><span class="token plain"> position-x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token lisp-property property" style="color:#36acaa">:name</span><span class="token plain"> y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         </span><span class="token lisp-property property" style="color:#36acaa">:initform</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         </span><span class="token lisp-property property" style="color:#36acaa">:initfunction</span><span class="token plain"> ,</span><span class="token quoted-symbol variable symbol" style="color:#36acaa">#&#x27;zero</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         </span><span class="token lisp-property property" style="color:#36acaa">:initargs</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token lisp-property property" style="color:#36acaa">:y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         </span><span class="token lisp-property property" style="color:#36acaa">:readers</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">position-y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         </span><span class="token lisp-property property" style="color:#36acaa">:writers</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">setf</span><span class="token plain"> position-y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token lisp-property property" style="color:#36acaa">:direct-default-initargs</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">`(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token lisp-property property" style="color:#36acaa">:engine</span><span class="token plain"> *propellor* ,</span><span class="token quoted-symbol variable symbol" style="color:#36acaa">#&#x27;propellor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="comments-and-remarks">Comments and remarks<a href="#comments-and-remarks" class="hash-link" aria-label="Direct link to Comments and remarks" title="Direct link to Comments and remarks">​</a></h5>
<p>This section is named <em>Initialization of Class Metaobjects</em> and appears in Chapter 5 (Concepts) of the original text. There is <a href="/cl-language-reference/meta-object-protocol/initialization-of-class-metaobjects2">a section with the same name in Chapter 6 (Generic functions and methods) of the original text.</a> When sections are referred to in the text, it is not specified which one.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5512-reinitialization-of-class-metaobjects">5.5.1.2 Reinitialization Of Class Metaobjects<a href="#5512-reinitialization-of-class-metaobjects" class="hash-link" aria-label="Direct link to 5.5.1.2 Reinitialization Of Class Metaobjects" title="Direct link to 5.5.1.2 Reinitialization Of Class Metaobjects">​</a></h3>
<!-- -->
<h1>Reinitialization of Class Metaobjects</h1>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="reinitialization-of-class-metaobjects-1">Reinitialization of Class Metaobjects<a href="#reinitialization-of-class-metaobjects-1" class="hash-link" aria-label="Direct link to Reinitialization of Class Metaobjects" title="Direct link to Reinitialization of Class Metaobjects">​</a></h4>
<p>Some class metaobject classes allow their instances to be reinitialized. This is done by calling <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_reinit.htm#reinitialize-instance" target="_blank" rel="noopener noreferrer">reinitialize-instance</a>. The initialization arguments have the same interpretation as in class initialization.</p>
<p>If the class metaobject was finalized before the call to <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_reinit.htm#reinitialize-instance" target="_blank" rel="noopener noreferrer">reinitialize-instance</a>, <a href="/cl-language-reference/meta-object-protocol/finalize-inheritance">finalize-inheritance</a> will be called again once all the initialization arguments have been processed and associated with the class metaobject. In addition, once finalization is complete, any dependents of the class metaobject will be updated by calling <a href="/cl-language-reference/meta-object-protocol/update-dependent">update-dependent</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5513-initialization-of-generic-function-and-method-metaobjects">5.5.1.3 Initialization Of Generic Function And Method Metaobjects<a href="#5513-initialization-of-generic-function-and-method-metaobjects" class="hash-link" aria-label="Direct link to 5.5.1.3 Initialization Of Generic Function And Method Metaobjects" title="Direct link to 5.5.1.3 Initialization Of Generic Function And Method Metaobjects">​</a></h3>
<!-- -->
<h1>Initialization of generic function and method metaobjects</h1>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="initialization-of-generic-function-and-method-metaobjects-1">Initialization of generic function and method metaobjects<a href="#initialization-of-generic-function-and-method-metaobjects-1" class="hash-link" aria-label="Direct link to Initialization of generic function and method metaobjects" title="Direct link to Initialization of generic function and method metaobjects">​</a></h4>
<p>An example of creating a generic function and a method metaobject, and then adding the method to the generic function is shown below. This example is comparable to the method definition shown in <a href="/cl-language-reference/meta-object-protocol/fig-defmethod-1">this figure</a>.</p>
<p>(let* ((gf (make-instance &#x27;standard-generic-function
<!-- -->:lambda-list<!-- --> &#x27;(p l &amp;optional visiblyp &amp;key)))
(method-class (generic-function-method-class gf)))
(multiple-value-bind (lambda initargs)
(make-method-lambda
gf
(class-prototype method-class)
&#x27;(lambda (p l &amp;optional (visiblyp t) &amp;key color)
(set-to-origin p)
(when visiblyp (show-move p 0 color)))
nil)
(add-method gf
(apply #&#x27;make-instance method-class
<!-- -->:function<!-- --> (compile nil lambda)
<!-- -->:specializers<!-- --> (list (find-class &#x27;position)
(intern-eql-specializer 0))
<!-- -->:qualifiers<!-- --> ()
<!-- -->:lambda-list<!-- --> &#x27;(p l &amp;optional (visiblyp t)
&amp;key color)
initargs))))</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="552-class-finalization-protocol">5.5.2 Class Finalization Protocol<a href="#552-class-finalization-protocol" class="hash-link" aria-label="Direct link to 5.5.2 Class Finalization Protocol" title="Direct link to 5.5.2 Class Finalization Protocol">​</a></h2>
<!-- -->
<h1>Class finalization protocol</h1>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="class-finalization-protocol-1">Class finalization protocol<a href="#class-finalization-protocol-1" class="hash-link" aria-label="Direct link to Class finalization protocol" title="Direct link to Class finalization protocol">​</a></h3>
<p>Class <em>finalization</em> is the process of computing the information a class inherits from its superclasses and preparing to actually allocate instances of the class. The class finalization process includes computing the class precedence list of the class, the full set of slots accessible in instances of the class and the full set of default initialization arguments for the class. These values are associated with the class metaobject and can be accessed by calling the appropriate reader. In addition, the class finalization process makes decisions about how instances of the class will be implemented.</p>
<p>To support forward-referenced superclasses, and to account for the fact that not all classes are actually instantiated, class finalization is not done as part of the initialization of the class metaobject. Instead, finalization is done as a separate protocol, invoked by calling the generic function <a href="/cl-language-reference/meta-object-protocol/finalize-inheritance">finalize-inheritance</a>. The exact point at which <a href="/cl-language-reference/meta-object-protocol/finalize-inheritance">finalize-inheritance</a> is called depends on the class of the class metaobject; for <a href="/cl-language-reference/meta-object-protocol/class-standard-class">standard-class</a> it is called sometime after all the superclasses of the class are defined, but no later than when the first instance of the class is allocated (by <a href="/cl-language-reference/meta-object-protocol/allocate-instance">allocate-instance</a>).</p>
<p>The first step of class finalization is computing the class precedence list. Doing this first allows subsequent steps to access the class precedence list. This step is performed by calling the generic function <a href="/cl-language-reference/meta-object-protocol/compute-class-precedence-list">compute-class-precedence-list</a>. The value returned from this call is associated with the class metaobject and can be accessed by calling the <a href="/cl-language-reference/meta-object-protocol/class-precedence-list">class-precedence-list</a> generic function.</p>
<p>The second step is computing the full set of slots that will be accessible in instances of the class. This step is performed by calling the generic function <a href="/cl-language-reference/meta-object-protocol/compute-slots">compute-slots</a>. The result of this call is a list of effective slot definition metaobjects. This value is associated with the class metaobject and can be accessed by calling the <a href="/cl-language-reference/meta-object-protocol/class-slots">class-slots</a> generic function.</p>
<p>The behavior of <a href="/cl-language-reference/meta-object-protocol/compute-slots">compute-slots</a> is itself layered, consisting of calls to <a href="/cl-language-reference/meta-object-protocol/effective-slot-definition-class">effective-slot-definition-class</a> and <a href="/cl-language-reference/meta-object-protocol/compute-effective-slot-definition">compute-effective-slot-definition</a>.</p>
<p>The final step of class finalization is computing the full set of initialization arguments for the class. This is done by calling the generic function <a href="/cl-language-reference/meta-object-protocol/compute-default-initargs">compute-default-initargs</a>. The value returned by this generic function is associated with the class metaobject and can be accessed by calling <a href="/cl-language-reference/meta-object-protocol/class-default-initargs">class-default-initargs</a>.</p>
<p>If the class was previously finalized, <a href="/cl-language-reference/meta-object-protocol/finalize-inheritance">finalize-inheritance</a> may call <a href="/cl-language-reference/chap-7/h-h-dictionary/make-instances-obsolete_standard-generic-function">make-instances-obsolete</a>. The circumstances under which this happens are describe in <a href="http://www.cs.cmu.edu/Groups/AI/html/cltl/clm/node300.md#SECTION0032110000000000000000" target="_blank" rel="noopener noreferrer">the section of the CLOS specification called ``Redefining Classes.&#x27;&#x27;</a>.</p>
<p>Forward-referenced classes, which provide a temporary definition for a class which has been referenced but not yet defined, can never be finalized. An error is signalled if <a href="/cl-language-reference/meta-object-protocol/finalize-inheritance">finalize-inheritance</a> is called on a forward-referenced class.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="553-instance-structure-protocol">5.5.3 Instance Structure Protocol<a href="#553-instance-structure-protocol" class="hash-link" aria-label="Direct link to 5.5.3 Instance Structure Protocol" title="Direct link to 5.5.3 Instance Structure Protocol">​</a></h2>
<!-- -->
<h1>Instance Structure Protocol</h1>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="instance-structure-protocol-1">Instance Structure Protocol<a href="#instance-structure-protocol-1" class="hash-link" aria-label="Direct link to Instance Structure Protocol" title="Direct link to Instance Structure Protocol">​</a></h3>
<p>The instance structure protocol is responsible for implementing the behavior of the slot access functions like <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_slt_va.htm#slot-value" target="_blank" rel="noopener noreferrer">slot-value</a> and <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_slt_va.htm#slot-value" target="_blank" rel="noopener noreferrer">(setf slot-value)</a>.</p>
<p>For each CLOS slot access function other than <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_slt_ex.htm#slot-exists-p" target="_blank" rel="noopener noreferrer">slot-exists-p</a>, there is a corresponding generic function which actually provides the behavior of the function. When called, the slot access function finds the pertinent effective slot definition metaobject, calls the corresponding generic function and returns its result. The arguments passed on to the generic function include one additional value, the class of the <em>object</em> argument, which always immediately precedes the <em>object</em> argument.</p>
<p>The correspondences between slot access function and underlying slot access generic function are as follows:</p>
<p>Slot access function                                                                                    Corresponding slot access generic function</p>
<hr>
<p><a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_slt_bo.htm#slot-boundp" target="_blank" rel="noopener noreferrer">slot-boundp</a>           <a href="/cl-language-reference/meta-object-protocol/slot-boundp-using-class">slot-boundp-using-class</a>
<a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_slt_ma.htm#slot-makunbound" target="_blank" rel="noopener noreferrer">slot-makunbound</a>   <a href="/cl-language-reference/meta-object-protocol/slot-makunbound-using-class">slot-makunbound-using-class</a>
<a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_slt_va.htm#slot-value" target="_blank" rel="noopener noreferrer">slot-value</a>             <a href="/cl-language-reference/meta-object-protocol/slot-value-using-class">slot-value-using-class</a>
<a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_slt_va.htm#slot-value" target="_blank" rel="noopener noreferrer">(setf slot-value)</a>      <a href="/cl-language-reference/meta-object-protocol/setf-slot-value-using-class">(setf slot-value-using-class)</a></p>
<p>At the lowest level, the instance structure protocol provides only limited mechanisms for portable programs to control the implementation of instances and to directly access the storage associated with instances without going through the indirection of slot access. This is done to allow portable programs to perform certain commonly requested slot access optimizations.</p>
<p>In particular, portable programs can control the implementation of, and obtain direct access to, slots with allocation <code>:instance</code> and type <strong>t</strong>. These are called <em>directly accessible slots</em>.</p>
<p>The relevant specified around-method on <a href="/cl-language-reference/meta-object-protocol/compute-slots">compute-slots</a> determines the implementation of instances by deciding how each slot in the instance will be stored. For each directly accessible slot, this method allocates a <em>location</em> and associates it with the effective slot definition metaobject. The location can be accessed by calling the <a href="/cl-language-reference/meta-object-protocol/slot-definition-location">slot-definition-location</a> generic function. Locations are non-negative integers. For a given class, the locations increase consecutively, in the order that the directly accessible slots appear in the list of effective slots. (Note that here, the next paragraph, and the specification of this around-method are the only places where the value returned by <a href="/cl-language-reference/meta-object-protocol/compute-slots">compute-slots</a> is described as a list rather than a set.)</p>
<p>Given the location of a directly accessible slot, the value of that slot in an instance can be accessed with the appropriate accessor. For <a href="/cl-language-reference/meta-object-protocol/class-standard-class">standard-class</a>, this accessor is the function <a href="/cl-language-reference/meta-object-protocol/standard-instance-access">standard-instance-access</a>. For <a href="/cl-language-reference/meta-object-protocol/class-funcallable-standard-class">funcallable-standard-class</a>, this accessor is the function <a href="/cl-language-reference/meta-object-protocol/funcallable-standard-instance-access">funcallable-standard-instance-access</a>. In each case, the arguments to the accessor are the instance and the slot location, in that order. See the definition of each accessor for additional restrictions on the use of these function.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example:<a href="#example" class="hash-link" aria-label="Direct link to Example:" title="Direct link to Example:">​</a></h4>
<p>The following example shows the use of this mechanism to implement a new class metaobject class, <code>ordered-class</code> and class option <code>:slot-order</code>. This option provides control over the allocation of slot locations. In this simple example implementation, the <code>:slot-order</code> option is not inherited by subclasses; it controls only instances of the class itself.</p>
<p>(defclass ordered-class (standard-class)
((slot-order <!-- -->:initform<!-- --> ()
<!-- -->:initarg<!-- --> <!-- -->:slot-order<!-- -->
<!-- -->:reader<!-- --> class-slot-order)))</p>
<p>(defmethod compute-slots ((class ordered-class))
(let ((order (class-slot-order class)))
(sort (copy-list (call-next-method))
#&#x27;(lambda (a b)
(&lt; (position (slot-definition-name a) order)
(position (slot-definition-name b) order))))))</p>
<p>Following is the source code the user of this extension would write. Note that because the code above doesn&#x27;t implement inheritance of the <code>:slot-order</code> option, the function <code>distance</code> must not be called on instances of subclasses of <code>point</code>; it can only be called on instances of <code>point</code> itself.</p>
<p>(defclass point ()
((x <!-- -->:initform<!-- --> 0)
(y <!-- -->:initform<!-- --> 0))
(<!-- -->:metaclass<!-- --> ordered-class)
(<!-- -->:slot-order<!-- --> x y))</p>
<p>(defun distance (point)
(sqrt (/ (+ (expt (standard-instance-access point 0) 2)
(expt (standard-instance-access point 1) 2))
2.0)))</p>
<p>In more realistic uses of this mechanism, the calls to the low-level instance structure accessors would not actually appear textually in the source program, but rather would be generated by a meta-level analysis program run during the process of compiling the source program.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="554-funcallable-instances">5.5.4 Funcallable Instances<a href="#554-funcallable-instances" class="hash-link" aria-label="Direct link to 5.5.4 Funcallable Instances" title="Direct link to 5.5.4 Funcallable Instances">​</a></h2>
<!-- -->
<h1>Funcallable Instances</h1>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="funcallable-instances-1">Funcallable Instances<a href="#funcallable-instances-1" class="hash-link" aria-label="Direct link to Funcallable Instances" title="Direct link to Funcallable Instances">​</a></h3>
<p>Instances of classes which are themselves instances of <a href="/cl-language-reference/meta-object-protocol/class-funcallable-standard-class">funcallable-standard-class</a> or one of its subclasses are called <em>funcallable instances</em>. Funcallable instances can only be created by <a href="/cl-language-reference/meta-object-protocol/allocate-instance-funcallable-standard-class">allocate-instance (class funcallable-standard-class)</a>.</p>
<p>Like standard instances, funcallable instances have slots with the normal behavior. They differ from standard instances in that they can be used as functions as well; that is, they can be passed to <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_funcal.htm#funcall" target="_blank" rel="noopener noreferrer">funcall</a> and <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_apply.htm#apply" target="_blank" rel="noopener noreferrer">apply</a>, and they can be stored as the definition of a function name. Associated with each funcallable instance is the function which it runs when it is called. This function can be changed with <a href="/cl-language-reference/meta-object-protocol/set-funcallable-instance-function">set-funcallable-instance-function</a></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a href="#example" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h4>
<p>The following simple example shows the use of funcallable instances to create a simple, <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_defstr.htm#defstruct" target="_blank" rel="noopener noreferrer">defstruct</a>-like facility. (Funcallable instances are useful when a program needs to construct and maintain a set of functions and information about those functions. They make it possible to maintain both as the same object rather than two separate objects linked, for example, by hash tables.)</p>
<div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">defclass</span><span class="token plain"> constructor </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">name</span><span class="token plain"> </span><span class="token lisp-property property" style="color:#36acaa">:initarg</span><span class="token plain"> </span><span class="token lisp-property property" style="color:#36acaa">:name</span><span class="token plain"> </span><span class="token lisp-property property" style="color:#36acaa">:accessor</span><span class="token plain"> constructor-name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">fields</span><span class="token plain"> </span><span class="token lisp-property property" style="color:#36acaa">:initarg</span><span class="token plain"> </span><span class="token lisp-property property" style="color:#36acaa">:fields</span><span class="token plain"> </span><span class="token lisp-property property" style="color:#36acaa">:accessor</span><span class="token plain"> constructor-fields</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token lisp-property property" style="color:#36acaa">:metaclass</span><span class="token plain"> funcallable-standard-class</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">defmethod</span><span class="token plain"> initialize-instance </span><span class="token lisp-property property" style="color:#36acaa">:after</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">c</span><span class="token plain"> constructor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> &amp;key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">with-slots</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">name</span><span class="token plain"> fields</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">set-funcallable-instance-function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          #</span><span class="token punctuation" style="color:#393A34">&#x27;(</span><span class="token lambda keyword" style="color:#00009f">lambda</span><span class="token lambda"> </span><span class="token lambda punctuation" style="color:#393A34">(</span><span class="token lambda arguments"></span><span class="token lambda punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">new</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">make-array</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">1+ </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">length</span><span class="token plain"> fields</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">setf</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">aref</span><span class="token plain"> new </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">setq</span><span class="token plain"> c1 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">make-instance</span><span class="token plain"> </span><span class="token quoted-symbol variable symbol" style="color:#36acaa">&#x27;constructor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token lisp-property property" style="color:#36acaa">:name</span><span class="token plain"> </span><span class="token quoted-symbol variable symbol" style="color:#36acaa">&#x27;position</span><span class="token plain"> </span><span class="token lisp-property property" style="color:#36acaa">:fields</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">&#x27;(</span><span class="token car">x</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #&lt;CONSTRUCTOR 262437&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">setq</span><span class="token plain"> p1 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token car">funcall</span><span class="token plain"> c1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #&lt;ARRAY </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> 263674&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="555-generic-function-invocation-protocol">5.5.5 Generic Function Invocation Protocol<a href="#555-generic-function-invocation-protocol" class="hash-link" aria-label="Direct link to 5.5.5 Generic Function Invocation Protocol" title="Direct link to 5.5.5 Generic Function Invocation Protocol">​</a></h2>
<!-- -->
<h1>Generic function invocation protocol</h1>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="generic-function-invocation-protocol-1">Generic function invocation protocol<a href="#generic-function-invocation-protocol-1" class="hash-link" aria-label="Direct link to Generic function invocation protocol" title="Direct link to Generic function invocation protocol">​</a></h3>
<p>Associated with each generic function is its discriminating function. Each time the generic function is called, the discriminating function is called to provide the behavior of the generic function. The discriminating function receives the full set of arguments received by the generic function. It must lookup and execute the appropriate methods, and return the appropriate values.</p>
<p>The discriminating function is computed by the highest layer of the generic function invocation protocol, <a href="/cl-language-reference/meta-object-protocol/compute-discriminating-function">compute-discriminating-function</a>. Whenever a generic function metaobject is initialized, reinitialized, or a method is added or removed, the discriminating function is recomputed. The new discriminating function is then stored with <a href="/cl-language-reference/meta-object-protocol/set-funcallable-instance-function">set-funcallable-instance-function</a>.</p>
<p>Discriminating functions call <a href="/cl-language-reference/meta-object-protocol/compute-applicable-methods">compute-applicable-methods</a> and <a href="/cl-language-reference/meta-object-protocol/compute-applicable-methods-using-classes">compute-applicable-methods-using-classes</a> to compute the methods applicable to the generic functions arguments. Applicable methods are combined by <a href="/cl-language-reference/meta-object-protocol/compute-effective-method">compute-effective-method</a> to produce an <em>effective method</em>. Provisions are made to allow memoization of the method applicability and effective methods computations. (See the description of <a href="/cl-language-reference/meta-object-protocol/compute-discriminating-function">compute-discriminating-function</a> for details.)</p>
<p>The body of method definitions are processed by <a href="/cl-language-reference/meta-object-protocol/make-method-lambda">make-method-lambda</a>. The result of this generic function is a lambda expression which is processed by either <a href="http://www.lispworks.com/documentation/HyperSpec/Body/f_cmp.htm#compile" target="_blank" rel="noopener noreferrer">compile</a> or the file compiler to produce a <em>method function</em>. The arguments received by the method function are controlled by the <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_call_m.htm#call-method" target="_blank" rel="noopener noreferrer">call-method</a> forms appearing in the effective methods. By default, method functions accept two arguments: a list of arguments to the generic function, and a list of next methods. The list of next methods corresponds to the next methods argument to <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_call_m.htm#call-method" target="_blank" rel="noopener noreferrer">call-method</a>. If <a href="http://www.lispworks.com/documentation/HyperSpec/Body/m_call_m.htm#call-method" target="_blank" rel="noopener noreferrer">call-method</a> appears with additional arguments, these will be passed to the method functions as well; in these cases, <a href="/cl-language-reference/meta-object-protocol/make-method-lambda">make-method-lambda</a> must have created the method lambdas to expect additional arguments.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="556-dependent-maintenance-protocol">5.5.6 Dependent Maintenance Protocol<a href="#556-dependent-maintenance-protocol" class="hash-link" aria-label="Direct link to 5.5.6 Dependent Maintenance Protocol" title="Direct link to 5.5.6 Dependent Maintenance Protocol">​</a></h2>
<!-- -->
<!-- -->
<h1>Dependent maintenance protocol</h1>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dependent-maintenance-protocol-1">Dependent maintenance protocol<a href="#dependent-maintenance-protocol-1" class="hash-link" aria-label="Direct link to Dependent maintenance protocol" title="Direct link to Dependent maintenance protocol">​</a></h3>
<p>It is convenient for portable metaobjects to be able to memoize information about other metaobjects, portable or otherwise. Because class and generic function metaobjects can be reinitialized, and generic function metaobjects can be modified by adding and removing methods, a means must be provided to update this memoized information.</p>
<p>The dependent maintenance protocol supports this by providing a way to register an object which should be notified whenever a class or generic function is modified. An object which has been registered this way is called a <em>dependent</em> of the class or generic function metaobject. The dependents of class and generic function metaobjects are maintained with <a href="/cl-language-reference/meta-object-protocol/add-dependent">add-dependent</a> and <a href="/cl-language-reference/meta-object-protocol/remove-dependent">remove-dependent</a>. The dependents of a class or generic function metaobject can be accessed with <a href="/cl-language-reference/meta-object-protocol/map-dependents">map-dependents</a>. Dependents are notified about a modification by calling <a href="/cl-language-reference/meta-object-protocol/update-dependent">update-dependent</a>. (See the specification of <a href="/cl-language-reference/meta-object-protocol/update-dependent">update-dependent</a> for detailed description of the circumstances under which it is called.)</p>
<p>To prevent conflicts between two portable programs, or between portable programs and the implementation, portable code must not register metaobjects themselves as dependents. Instead, portable programs which need to record a metaobject as a dependent, should encapsulate that metaobject in some other kind of object, and record that object as the dependent. The results are undefined if this restriction is violated.</p>
<p><strong>Example:</strong></p>
<p>This example shows a general facility for encapsulating metaobjects before recording them as dependents. The facility defines a basic kind of encapsulating object: an updater. Specializations of the basic class can be defined with appropriate special updating behavior. In this way, information about the updating required is associated with each updater rather than with the metaobject being updated.</p>
<p>Updaters are used to encapsulate any metaobject which requires updating when a given class or generic function is modified. The function record-updater is called to both create an updater and add it to the dependents of the class or generic function. Methods on the generic function <a href="/cl-language-reference/meta-object-protocol/update-dependent">update-dependent</a>, specialized to the specific class of updater do the appropriate update work.</p>
<p>(defclass updater ()
((dependent <!-- -->:initarg<!-- --> <!-- -->:dependent<!-- --> <!-- -->:reader<!-- --> dependent)))</p>
<p>(defun record-updater (class dependee dependent &amp;rest initargs)
(let ((updater (apply #&#x27;make-instance class <!-- -->:dependent<!-- --> dependent
initargs)))
(add-dependent dependee updater)
updater))</p>
<p>A <code>flush-cache-updater</code> simply flushes the cache of the dependent when it is updated.</p>
<p>(defclass flush-cache-updater (updater) ())</p>
<p>(defmethod update-dependent (dependee (updater flush-cache-updater)
&amp;rest args)
(declare (ignore args))
(flush-cache (dependent updater)))</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/lisp-docs/cl-language-reference/tree/main/docs/meta-object-protocol/chap-5/5-5-subprotocols.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> by <b>daninus14</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cl-language-reference/meta-object-protocol/chap-5/5-4-processing"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">5.4 Processing Of The User Interface Macros</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cl-language-reference/category/chapter-6---generic-functions-and-methods"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Chapter 6 - Generic Functions and Methods</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#551-metaobject-initialization-protocols" class="table-of-contents__link toc-highlight">5.5.1 Metaobject Initialization Protocols</a><ul><li><a href="#5511-initialization-of-class-metaobjects" class="table-of-contents__link toc-highlight">5.5.1.1 Initialization Of Class Metaobjects</a></li><li><a href="#5512-reinitialization-of-class-metaobjects" class="table-of-contents__link toc-highlight">5.5.1.2 Reinitialization Of Class Metaobjects</a></li><li><a href="#5513-initialization-of-generic-function-and-method-metaobjects" class="table-of-contents__link toc-highlight">5.5.1.3 Initialization Of Generic Function And Method Metaobjects</a></li></ul></li><li><a href="#552-class-finalization-protocol" class="table-of-contents__link toc-highlight">5.5.2 Class Finalization Protocol</a></li><li><a href="#553-instance-structure-protocol" class="table-of-contents__link toc-highlight">5.5.3 Instance Structure Protocol</a></li><li><a href="#554-funcallable-instances" class="table-of-contents__link toc-highlight">5.5.4 Funcallable Instances</a></li><li><a href="#555-generic-function-invocation-protocol" class="table-of-contents__link toc-highlight">5.5.5 Generic Function Invocation Protocol</a></li><li><a href="#556-dependent-maintenance-protocol" class="table-of-contents__link toc-highlight">5.5.6 Dependent Maintenance Protocol</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://lisp-docs.github.io/docs/tutorial" target="_blank" rel="noopener noreferrer" class="footer__link-item">Common Lisp Tutorial</a></li><li class="footer__item"><a href="https://lisp-docs.github.io/cl-language-reference/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Common Lisp Technical Reference</a></li><li class="footer__item"><a href="https://lisp-docs.github.io/docs/help" target="_blank" rel="noopener noreferrer" class="footer__link-item">Help</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/common-lisp" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/hhk46CE" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.reddit.com/r/common_lisp" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reddit<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://irclog.tymoon.eu/libera/commonlisp" target="_blank" rel="noopener noreferrer" class="footer__link-item">IRC<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://lisp-docs.github.io/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/lisp-docs/lisp-docs.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Tutorial and General Content GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/lisp-docs/cl-language-reference/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Technical Reference GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://lisp-docs.github.io/docs/contribute" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contribute to the Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Common Lisp Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://lisp-docs.github.io/docs/about" target="_blank" rel="noopener noreferrer" class="footer__link-item">About</a></li><li class="footer__item"><a href="https://lisp-docs.github.io/docs/whylisp" target="_blank" rel="noopener noreferrer" class="footer__link-item">Why Lisp</a></li><li class="footer__item"><a href="https://lisp-docs.github.io/docs/getting-started" target="_blank" rel="noopener noreferrer" class="footer__link-item">Getting Started</a></li><li class="footer__item"><a href="https://lisp-docs.github.io/docs/faq" target="_blank" rel="noopener noreferrer" class="footer__link-item">FAQ</a></li><li class="footer__item"><a href="https://lisp-docs.github.io/docs/help" target="_blank" rel="noopener noreferrer" class="footer__link-item">Getting Help</a></li><li class="footer__item"><a href="https://lisp-docs.github.io/docs/howto" target="_blank" rel="noopener noreferrer" class="footer__link-item">How To Guides</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Common Lisp Docs, MIT License (see GitHub Repo).</div></div></div></footer></div>
</body>
</html>